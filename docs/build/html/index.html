
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Welcome to PySpecTools’s documentation! &#8212; PySpecTools 3.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-pyspectools-s-documentation">
<h1>Welcome to PySpecTools’s documentation!<a class="headerlink" href="#welcome-to-pyspectools-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="module-pyspectools">
<span id="pyspectools-main"></span><h1>PySpectools main<a class="headerlink" href="#module-pyspectools" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="pyspectools-autofit">
<h1>PySpectools autofit<a class="headerlink" href="#pyspectools-autofit" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="module-pyspectools.doubleresonance">
<span id="pyspectools-doubleresonance"></span><h1>PySpectools doubleresonance<a class="headerlink" href="#module-pyspectools.doubleresonance" title="Permalink to this headline">¶</a></h1>
<p>Routines for fitting double resonance data</p>
<dl class="function">
<dt id="pyspectools.doubleresonance.baseline_als">
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">baseline_als</code><span class="sig-paren">(</span><em>y</em>, <em>lam=1000000000.0</em>, <em>p=0.1</em>, <em>niter=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#baseline_als"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.baseline_als" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for performing an iterative baseline
fitting using the asymmetric least squares algorithm.</p>
<p>This refers to the paper:
“Baseline Correction with Asymmetric Least Squares Smoothing”
by Eilers and Boelens (2005).</p>
<p>The code is taken from a Stack Overflow question:
<a class="reference external" href="https://stackoverflow.com/a/29185844">https://stackoverflow.com/a/29185844</a></p>
<p>According to the paper, the tested values are:
0.001 &lt;= p &lt;= 0.1 for positive peaks
1e2 &lt;= lam &lt;= 1e9</p>
<p>y - data used to fit the baseline
lam - tuning factor for penalty function that offsets</p>
<blockquote>
<div>the difference cost function</div></blockquote>
<p>p - weighting factor for the cost function</p>
<p>z - array containing the baseline values</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.doubleresonance.fit_dr">
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">fit_dr</code><span class="sig-paren">(</span><em>dataframe</em>, <em>col='Average'</em>, <em>baseline=True</em>, <em>guess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#fit_dr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.fit_dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for fitting double resonance data.</p>
<p>dataframe - pandas dataframe containing</p>
<p>col - str denoting which column to use for fitting.
baseline - boolean denoting whether a linear baseline is fit
guess - dict for fitting parameters; this is passed into</p>
<blockquote>
<div>the fit directly and so must match the lmfit convention.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pyspectools.doubleresonance.init_dr_model">
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">init_dr_model</code><span class="sig-paren">(</span><em>baseline=False</em>, <em>guess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#init_dr_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.init_dr_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to serialize a Model object for DR fits.
Defaults to a Gaussian line shape, but the option to include
a linear offset is available.</p>
<p>Additionally, if a guess is provided in the
lmfit convention then it will be incorporated.</p>
<p>baseline - boolean indicating if linear offset is included
guess - nested dict with keys corresponding to parameter name</p>
<blockquote>
<div>and values corresponding to dicts with key/value
indicating the parameter value, range, and constraints</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pyspectools.doubleresonance.parse_data">
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">parse_data</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#parse_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.parse_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a DR file. When there are multiple columns present
in the file, this is interpreted as multiple channels being used to
monitor during the DR experiment. In this case, we do the analysis on
the co-average of these columns.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.doubleresonance.peak_detect">
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">peak_detect</code><span class="sig-paren">(</span><em>dataframe</em>, <em>col='Average'</em>, <em>interpolate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#peak_detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.peak_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine for peak detection to provide an initial
guess for the center frequency.</p>
<p>The algorithm assumes that the ten smallest intensities
corresponds to where the depletion approximately is.</p>
<p>By default, a cubic spline is performed on the intensities
so that a finer grid of points gives a better determination
of the center frequency.</p>
</dd></dl>

</div>
<div class="section" id="id1">
<h1>PySpectools doubleresonance<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-pyspectools.doubleresonance"></span><p>Routines for fitting double resonance data</p>
<dl class="function">
<dt>
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">baseline_als</code><span class="sig-paren">(</span><em>y</em>, <em>lam=1000000000.0</em>, <em>p=0.1</em>, <em>niter=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#baseline_als"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function for performing an iterative baseline
fitting using the asymmetric least squares algorithm.</p>
<p>This refers to the paper:
“Baseline Correction with Asymmetric Least Squares Smoothing”
by Eilers and Boelens (2005).</p>
<p>The code is taken from a Stack Overflow question:
<a class="reference external" href="https://stackoverflow.com/a/29185844">https://stackoverflow.com/a/29185844</a></p>
<p>According to the paper, the tested values are:
0.001 &lt;= p &lt;= 0.1 for positive peaks
1e2 &lt;= lam &lt;= 1e9</p>
<p>y - data used to fit the baseline
lam - tuning factor for penalty function that offsets</p>
<blockquote>
<div>the difference cost function</div></blockquote>
<p>p - weighting factor for the cost function</p>
<p>z - array containing the baseline values</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">fit_dr</code><span class="sig-paren">(</span><em>dataframe</em>, <em>col='Average'</em>, <em>baseline=True</em>, <em>guess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#fit_dr"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function for fitting double resonance data.</p>
<p>dataframe - pandas dataframe containing</p>
<p>col - str denoting which column to use for fitting.
baseline - boolean denoting whether a linear baseline is fit
guess - dict for fitting parameters; this is passed into</p>
<blockquote>
<div>the fit directly and so must match the lmfit convention.</div></blockquote>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">init_dr_model</code><span class="sig-paren">(</span><em>baseline=False</em>, <em>guess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#init_dr_model"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function to serialize a Model object for DR fits.
Defaults to a Gaussian line shape, but the option to include
a linear offset is available.</p>
<p>Additionally, if a guess is provided in the
lmfit convention then it will be incorporated.</p>
<p>baseline - boolean indicating if linear offset is included
guess - nested dict with keys corresponding to parameter name</p>
<blockquote>
<div>and values corresponding to dicts with key/value
indicating the parameter value, range, and constraints</div></blockquote>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">parse_data</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#parse_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function to read in a DR file. When there are multiple columns present
in the file, this is interpreted as multiple channels being used to
monitor during the DR experiment. In this case, we do the analysis on
the co-average of these columns.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pyspectools.doubleresonance.</code><code class="descname">peak_detect</code><span class="sig-paren">(</span><em>dataframe</em>, <em>col='Average'</em>, <em>interpolate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#peak_detect"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Routine for peak detection to provide an initial
guess for the center frequency.</p>
<p>The algorithm assumes that the ten smallest intensities
corresponds to where the depletion approximately is.</p>
<p>By default, a cubic spline is performed on the intensities
so that a finer grid of points gives a better determination
of the center frequency.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.figurefactory">
<span id="pyspectools-figurefactory"></span><h1>PySpectools figurefactory<a class="headerlink" href="#module-pyspectools.figurefactory" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyspectools.figurefactory.add_image">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">add_image</code><span class="sig-paren">(</span><em>axis, filepath, zoom=0.15, position=[0.0, 0.0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#add_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.add_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to add an image annotation to a specified axis.</p>
<p>Takes the matplotlib axis and filepath to the image as input,
and optional arguments for the scaling (zoom) and position of
the image in axis units.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.figurefactory.calc_vibE">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">calc_vibE</code><span class="sig-paren">(</span><em>quant_nums</em>, <em>vibrations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#calc_vibE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.calc_vibE" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will calculate a 1D array of
vibrational energies, based on a nested list
of quantum numbers and a list of vibrational
frequencies.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.figurefactory.generate_x_coord">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">generate_x_coord</code><span class="sig-paren">(</span><em>quant_nums</em>, <em>energies</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#generate_x_coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.generate_x_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate the x coordinate for plotting
based on the quantum numbers specified.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.figurefactory.make_elevel_plot">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">make_elevel_plot</code><span class="sig-paren">(</span><em>cat_dict</em>, <em>axis</em>, <em>color</em>, <em>maxE</em>, <em>alpha=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#make_elevel_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.make_elevel_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>make_elevel_plot is used to create energy level diagrams
with Matplotlib axis objects. This is considered slightly
lower level: you should call the higher level wrapper functions
like vib_energy_diagram instead!</p>
<p>The function will loop over every transition that has
been categorized/binned into an x-axis index, and sub-
sequently plot each x-bin individually.</p>
<p>The input arguments are:</p>
<p>cat_dict: dict-like with keys as the x-axis values, and
the items are dictionaries containing the energy and
quantum number configuration.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.figurefactory.make_pes">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">make_pes</code><span class="sig-paren">(</span><em>x</em>, <em>energies</em>, <em>width=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#make_pes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.make_pes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create a smooth PES, where stationary 
points are connected.</p>
<p>Basically makes a linearly spaced x array which
pads x-axis density to create the horizontal line
for the stationary points</p>
<p>Optional arguments are how many x-points to 
pad with on either side.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.figurefactory.vib_energy_diagram">
<code class="descclassname">pyspectools.figurefactory.</code><code class="descname">vib_energy_diagram</code><span class="sig-paren">(</span><em>quant_nums</em>, <em>vibrations</em>, <em>maxV=2</em>, <em>maxE=3000.0</em>, <em>useFull=True</em>, <em>image=None</em>, <em>imagesize=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#vib_energy_diagram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.vib_energy_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will generate a vibrational energy diagram.</p>
<p>This function wraps the make_elevel_plot function!</p>
<p>Input arguments are</p>
<p>quant_nums: A 2D numpy array of quantum numbers, where each row is
a single configuration.
vibrations: A list of vibrational frequencies.
maxV: The maximum quanta for considering predicted frequencies.
maxE: Maximum energy for plotting.
useFull: Boolean for flagging whether predict frequencies are plotted.
image: String-like for specifying path to an image.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.fitting">
<span id="pyspectools-fitting"></span><h1>PySpectools fitting<a class="headerlink" href="#module-pyspectools.fitting" title="Permalink to this headline">¶</a></h1>
<p>Wrapper functions for lmfit.</p>
<p>Each module of PySpectools should use these functions
when fitting is required, rather than rewrite for each
purpose.</p>
<dl class="function">
<dt id="pyspectools.fitting.calc_harmonic_transition">
<code class="descclassname">pyspectools.fitting.</code><code class="descname">calc_harmonic_transition</code><span class="sig-paren">(</span><em>J</em>, <em>B</em>, <em>D=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#calc_harmonic_transition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.calc_harmonic_transition" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the transition frequency for
a given upper state J, B, and D.</p>
<p>J - quantum number
B - rotational constant in MHz
D - centrifugal distortion constant in MHz</p>
<p>transition frequency in MHz</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.fitting.construct_lineshape_mod">
<code class="descclassname">pyspectools.fitting.</code><code class="descname">construct_lineshape_mod</code><span class="sig-paren">(</span><em>func_name='gaussian'</em>, <em>n=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#construct_lineshape_mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.construct_lineshape_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes a model object from lmfit using the specified
lineshape function.</p>
<p>The arguments are string name of the function, and n for
the number of lineshape functions to model.</p>
<p>This function is generalized by hard-coding two cases:
one where the functions are included in lmfit.models, and
the other where they are not included, such as the second
derivative line profiles.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.fitting.harmonic_fitter">
<code class="descclassname">pyspectools.fitting.</code><code class="descname">harmonic_fitter</code><span class="sig-paren">(</span><em>progressions</em>, <em>J_thres=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#harmonic_fitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.harmonic_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will sequentially fit every progression
with a simple harmonic model defined by B and D. The
“B” value here actually corresponds to B+C for a near-prolate,
or 2B for a prolate top.</p>
<p>There are a number of filters applied in order to minimize
calculations that won’t be meaningful - these parameters
may have to be tuned for different test cases.</p>
<p>Because the model is not actually quantized, J is
represented as a float. To our advantage, this will
actually separate real (molecular) progressions from
fake news; at least half of the J values must be
close to being an integer for us to consider fitting.</p>
<p>progressions - iterable containing arrays of progressions
J_thres - optional argument corresponding to how close a</p>
<blockquote>
<div>value must be to an integer</div></blockquote>
<p>pandas dataframe containing the fit results; columns
are B, D, fit RMS, and pairs of columns corresponding
to the fitted frequency and approximate J value.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.fitting.quant_check">
<code class="descclassname">pyspectools.fitting.</code><code class="descname">quant_check</code><span class="sig-paren">(</span><em>value</em>, <em>threshold=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#quant_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.quant_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will check if a value is close
to an integer to the absolute value of the threshold.</p>
<p>value - float for number to check
threshold - float determining whether value is</p>
<blockquote>
<div>close enough to being integer</div></blockquote>
<p>True if the value is close enough to being an integer,
False otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.fitting.rotor_energy">
<code class="descclassname">pyspectools.fitting.</code><code class="descname">rotor_energy</code><span class="sig-paren">(</span><em>J</em>, <em>B</em>, <em>D=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#rotor_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.rotor_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Expression for a linear/prolate top with
centrifugal distortion.</p>
<p>J - integer quantum number
B - rotational constant in MHz
D - CD term in MHz</p>
<p>state energy in MHz</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.spectra">
<span id="pyspectools-spectra"></span><h1>PySpectools spectra<a class="headerlink" href="#module-pyspectools.spectra" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="module-pyspectools.spectra.analysis">
<span id="pyspectools-spectra-analysis"></span><h1>PySpectools spectra.analysis<a class="headerlink" href="#module-pyspectools.spectra.analysis" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyspectools.spectra.analysis.assign_peaks">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">assign_peaks</code><span class="sig-paren">(</span><em>spec_df</em>, <em>frequencies</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#assign_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.assign_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Higher level function that will help assign features
in a chirp spectrum.</p>
<p>Input arguments:
spec_df - pandas dataframe containing chirp data
frequencies - iterable containing center frequencies of peaks
Optional arguments are passed into the peak detection as well
as in the plotting functions.</p>
<p>Returns a dataframe containing all the assignments, and a list
of unidentified peak frequencies.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.brute_harmonic_search">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">brute_harmonic_search</code><span class="sig-paren">(</span><em>frequencies</em>, <em>maxJ=10</em>, <em>dev_thres=5.0</em>, <em>prefilter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#brute_harmonic_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.brute_harmonic_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will search for possible harmonic candidates
in a list of frequencies. Wraps the lower level function.</p>
<p>Generates every possible 4 membered combination of the
frequencies, and makes a first pass filtering out unreasonable
combinations.</p>
<p>frequencies - iterable containing floats of frequencies (ulines)
maxJ - maximum value of J considered for quantum numbers
dev_thres - standard deviation threshold for filtering unlikely</p>
<blockquote>
<div>combinations of frequencies</div></blockquote>
<dl class="docutils">
<dt>prefilter - bool dictating whether or not the frequency lists</dt>
<dd>are prescreened by standard deviation. This potentially
biases away from missing transitions!</dd>
</dl>
<dl class="docutils">
<dt>results_df - pandas dataframe containing RMS information and fitted</dt>
<dd>constants</dd>
</dl>
<p>fit_results - list containing all of ModelResult objects</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.cluster_AP_analysis">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">cluster_AP_analysis</code><span class="sig-paren">(</span><em>progression_df</em>, <em>sil_calc=False</em>, <em>refit=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#cluster_AP_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.cluster_AP_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the AffinityPropagation cluster method from
scikit-learn.</p>
<p>The dataframe provided will also receive new columns: Cluster index,
and Silhouette. The latter corresponds to how likely a sample is
sandwiched between clusters (0), how squarely it belongs in the
assigned cluster (+1), or does not belong (-1). The cluster index
corresponds to which cluster the sample belongs to.</p>
<dl class="docutils">
<dt>progression_df - pandas dataframe taken from the result of progression</dt>
<dd>fits</dd>
<dt>sil_calc - bool indicating whether silhouettes are calculated</dt>
<dd>after the AP model is fit</dd>
</dl>
<p>data - dict containing clustered frequencies and associated fits
ap_obj - AffinityPropagation object containing all the information</p>
<blockquote>
<div>as attributes.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.find_series">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">find_series</code><span class="sig-paren">(</span><em>combo</em>, <em>frequencies</em>, <em>search=0.005</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#find_series"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.find_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will exhaustively search for candidate
progressions based on a pair of frequencies.</p>
<p>The difference of the pair is used to estimate B,
which is then used to calculate J. These values of
J are then used to predict the next set of lines,
which are searched for in the soup of frequencies.
The closest matches are added to a list which is returned.</p>
<p>This is done so that even if frequencies are missing
a series of lines can still be considered.</p>
<p>combo - pair of frequencies corresponding to initial guess
frequencies - array of frequencies to be searched
search - optional threshold for determining the search range</p>
<blockquote>
<div>to look for candidates</div></blockquote>
<p>array of candidate frequencies</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.fit_line_profile">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">fit_line_profile</code><span class="sig-paren">(</span><em>spec_df</em>, <em>frequency</em>, <em>intensity=None</em>, <em>name=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#fit_line_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.fit_line_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function wrapper to to fit line profiles
in chirp spectra.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.harmonic_finder">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">harmonic_finder</code><span class="sig-paren">(</span><em>frequencies</em>, <em>search=0.001</em>, <em>low_B=400.0</em>, <em>high_B=9000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#harmonic_finder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.harmonic_finder" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will generate candidates for progressions.
Every possible pair combination of frequencies are
looped over, consider whether or not the B value is either
too small (like C60 large) or too large (you won’t have
enough lines to make a progression), and search the
frequencies to find the nearest candidates based on a
prediction.</p>
<dl class="docutils">
<dt>frequencies - array or tuple-like containing the progressions</dt>
<dd>we expect to find</dd>
<dt>search - optional argument threshold for determining if something</dt>
<dd>is close enough</dd>
</dl>
<p>progressions - list of arrays corresponding to candidate progressions</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.peak_find">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">peak_find</code><span class="sig-paren">(</span><em>spec_df</em>, <em>freq_col='Frequency'</em>, <em>int_col='Intensity'</em>, <em>thres=0.015</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#peak_find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.peak_find" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for peakutils applied to pandas dataframes. First finds
the peak indices, which are then used to fit Gaussians to determine
the center frequency for each peak.</p>
<p>spec_df - dataframe containing the spectrum
freq_col - str denoting frequency column
int_col - str denoting intensity column
thres - threshold for peak detection</p>
<p>peak_df - pandas dataframe containing the peaks frequency/intensity</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.analysis.search_center_frequency">
<code class="descclassname">pyspectools.spectra.analysis.</code><code class="descname">search_center_frequency</code><span class="sig-paren">(</span><em>frequency</em>, <em>width=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/analysis.html#search_center_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.analysis.search_center_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the astroquery Splatalogue search
This function will take a center frequency, and query splatalogue
within the CDMS and JPL linelists for carriers of the line.</p>
<p>Input arguments:
frequency - float specifying the center frequency</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.spectra.artifacts">
<span id="pyspectools-spectra-artifacts"></span><h1>PySpectools spectra.artifacts<a class="headerlink" href="#module-pyspectools.spectra.artifacts" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyspectools.spectra.artifacts.artifact_detection">
<code class="descclassname">pyspectools.spectra.artifacts.</code><code class="descname">artifact_detection</code><span class="sig-paren">(</span><em>spec_path, freq_range=[8000.0, 19000.0], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/artifacts.html#artifact_detection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.artifacts.artifact_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for detecting and storing chirp artifacts
for later use.</p>
<p>The input parameters are:
spec_path - path to a chirp spectrum
freq_range - frequency range</p>
<p>Additional kwargs can be passed to the peak
detection functions; this wraps around the
peakutils functions.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.artifacts.remove_artifacts">
<code class="descclassname">pyspectools.spectra.artifacts.</code><code class="descname">remove_artifacts</code><span class="sig-paren">(</span><em>spec_df</em>, <em>artifact_path</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/artifacts.html#remove_artifacts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.artifacts.remove_artifacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for removing artifacts from a spectrum.
A csv containing artifacts is loaded, and goes through
fitting and subtracting them from the actual spectrum.</p>
<p>Input arguments are:
spec_df - dataframe containing the actual spectrum you want
to clean
artifact_path - path to a csv file containing the frequency
and peak intensities
verbose - if True, prints out the fitting results</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.spectra.assignment">
<span id="pyspectools-spectra-assignment"></span><h1>PySpectools spectra.assignment<a class="headerlink" href="#module-pyspectools.spectra.assignment" title="Permalink to this headline">¶</a></h1>
<p>assignment.py</p>
<p>Contains dataclass routines for tracking assignments
in broadband spectra.</p>
<dl class="class">
<dt id="pyspectools.spectra.assignment.Assignment">
<em class="property">class </em><code class="descclassname">pyspectools.spectra.assignment.</code><code class="descname">Assignment</code><span class="sig-paren">(</span><em>name: str = ''</em>, <em>smiles: str = ''</em>, <em>formula: str = ''</em>, <em>frequency: float = 0.0</em>, <em>catalog_frequency: float = 0.0</em>, <em>intensity: float = 0.0</em>, <em>peak_id: int = 0</em>, <em>experiment: int = 0</em>, <em>uline: bool = True</em>, <em>composition: List[str] = &lt;factory&gt;</em>, <em>v_qnos: List[int] = &lt;factory&gt;</em>, <em>r_qnos: str = ''</em>, <em>fit: Dict[KT</em>, <em>VT] = &lt;factory&gt;</em>, <em>ustate_energy: float = 0.0</em>, <em>interference: bool = False</em>, <em>weighting: float = 0.0</em>, <em>source: str = 'Catalog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment" title="Permalink to this definition">¶</a></dt>
<dd><p>DataClass for handling assignments.
There should be sufficient information to store a
line assignment and reproduce it later in a form
that is both machine and human readable.</p>
<p>name - str representing IUPAC/common name
formula - str representing chemical formula
smiles - str representing SMILES code (specific!)
frequency - float for observed frequency
intensity - float for observed intensity
peak_id - int for peak id from experiment
uline - bool flag to signal whether line is identified or not
composition - list-like with string corresponding to experimental</p>
<blockquote>
<div>chemical composition. SMILES syntax.</div></blockquote>
<dl class="docutils">
<dt>v_qnos - list with quantum numbers for vibrational modes. Index</dt>
<dd>corresponds to mode, and int value to number of quanta.
Length should be equal to 3N-6.</dd>
</dl>
<p>experiment - int for experiment ID
fit - dict-like containing the fitted parameters and model</p>
<dl class="classmethod">
<dt id="pyspectools.spectra.assignment.Assignment.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>data_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for generating an Assignment object
from a dictionary. All this method does is
unpack a dictionary into the __init__ method.</p>
<p>data_dict - dict with DataClass fields</p>
<p>Assignment object</p>
</dd></dl>

<dl class="classmethod">
<dt id="pyspectools.spectra.assignment.Assignment.from_json">
<em class="property">classmethod </em><code class="descname">from_json</code><span class="sig-paren">(</span><em>json_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment.from_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for initializing an Assignment object
from a JSON file.</p>
<p>json_path - str path to json file</p>
<p>Assignment object</p>
</dd></dl>

<dl class="classmethod">
<dt id="pyspectools.spectra.assignment.Assignment.from_yml">
<em class="property">classmethod </em><code class="descname">from_yml</code><span class="sig-paren">(</span><em>yaml_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment.from_yml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment.from_yml" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for initializing an Assignment object
from a YAML file.</p>
<p>yaml_path - str path to yaml file</p>
<p>Assignment object</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.Assignment.get_spectrum">
<code class="descname">get_spectrum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment.get_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment.get_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a synthetic peak by supplying
the x axis for a particular spectrum. This method
assumes that some fit parameters have been determined
previously.</p>
<p>x - 1D array with frequencies of experiment</p>
<p>y - 1D array of synthetic Gaussian spectrum</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.Assignment.to_file">
<code class="descname">to_file</code><span class="sig-paren">(</span><em>filepath</em>, <em>format='yaml'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Assignment.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Assignment.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to dump data to YAML format.
Extensions are automatically decided, but
can also be supplied.</p>
<p>filepath - str path to yaml file
format - str denoting the syntax used for dumping.</p>
<blockquote>
<div>Defaults to YAML.</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspectools.spectra.assignment.AssignmentSession">
<em class="property">class </em><code class="descclassname">pyspectools.spectra.assignment.</code><code class="descname">AssignmentSession</code><span class="sig-paren">(</span><em>exp_dataframe</em>, <em>experiment</em>, <em>composition</em>, <em>temperature=4.0</em>, <em>freq_col='Frequency'</em>, <em>int_col='Intensity'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for managing a session of assigning molecules
to a broadband spectrum.</p>
<p>Wraps some high level functionality from the analysis
module so that this can be run reproducibly in a jupyter
notebook.</p>
<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.assign_line">
<code class="descname">assign_line</code><span class="sig-paren">(</span><em>name</em>, <em>index=None</em>, <em>frequency=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.assign_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.assign_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a transition as assigned, and dump it into
the assignments list attribute.</p>
<dl class="docutils">
<dt>The two methods for doing this is to supply either:</dt>
<dd><ol class="first last arabic simple">
<li>U-line index</li>
<li>U-line frequency</li>
</ol>
</dd>
</dl>
<p>One way or the other, the U-line Assignment object
will be updated to signify the new assignment.
Optional kwargs will also be passed to the Assignment
object to update any other details.</p>
<p>name - str denoting the name of the molecule
index - optional arg specifying U-line index
frequency - optional float specifying frequency to assign
<a href="#id2"><span class="problematic" id="id3">**</span></a>kwargs - passed to update Assignment object</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.calc_line_weighting">
<code class="descname">calc_line_weighting</code><span class="sig-paren">(</span><em>frequency</em>, <em>catalog_df</em>, <em>prox=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.calc_line_weighting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.calc_line_weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating the weighting factor for determining
the likely hood of an assignment. The weighting factor is
determined by the proximity of the catalog frequency to the
observed frequency, as well as the theoretical intensity if it
is available.</p>
<p>frequency - float observed frequency in MHz
catalog_df - dataframe corresponding to catalog entries
prox - optional float for frequency proximity threshold</p>
<p>If nothing matches the frequency, returns None.
If matches are found, calculate the weights and return the candidates
in a dataframe.</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.clean_folder">
<code class="descname">clean_folder</code><span class="sig-paren">(</span><em>action=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.clean_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.clean_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for cleaning up all of the directories used by this routine.
Use with caution!!!</p>
<p>Requires passing a True statement to actually clean up.</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.finalize_assignments">
<code class="descname">finalize_assignments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.finalize_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.finalize_assignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will complete the assignment process by
serializing DataClass objects and formatting a report.</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.find_peaks">
<code class="descname">find_peaks</code><span class="sig-paren">(</span><em>threshold=0.015</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.find_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.find_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap peakutils method for detecting peaks.</p>
<p>threshold - peak detection threshold</p>
<p>peaks_df - dataframe containing peaks</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.find_progressions">
<code class="descname">find_progressions</code><span class="sig-paren">(</span><em>search=0.001</em>, <em>low_B=400.0</em>, <em>high_B=9000.0</em>, <em>sil_calc=True</em>, <em>refit=False</em>, <em>plot=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.find_progressions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.find_progressions" title="Permalink to this definition">¶</a></dt>
<dd><p>High level function for searching U-line database for
possible harmonic progressions. Wraps the lower level function
harmonic_search, which will generate 3-4 frequency combinations
to search.</p>
<dl class="docutils">
<dt>search - threshold for determining if quantum number J is close</dt>
<dd>enough to an integer/half-integer</dd>
</dl>
<p>low_B - minimum value for B
high_B - maximum value for B
plot - whether or not to produce a plot of the progressions</p>
<p>harmonic_df - dataframe containing the viable transitions</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.get_assigned_names">
<code class="descname">get_assigned_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.get_assigned_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.get_assigned_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for getting all the unique molecules out
of the assignments, and tally up the counts.</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.in_experiment">
<code class="descname">in_experiment</code><span class="sig-paren">(</span><em>frequency</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.in_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.in_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to ask a simple yes/no if the frequency
exists in either U-lines or assignments.</p>
<p>frequency - float corresponding to frequency in MHz</p>
<p>bool - True if it’s in ulines/assignments, False otherwise</p>
</dd></dl>

<dl class="classmethod">
<dt id="pyspectools.spectra.assignment.AssignmentSession.load_session">
<em class="property">classmethod </em><code class="descname">load_session</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.load_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.load_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an AssignmentSession from disk, once it has
been saved with the save_session method.</p>
<dl class="docutils">
<dt>filepath - path to the AssignmentSession file; typically</dt>
<dd>in the sessions/{experiment_id}.dat</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.plot_assigned">
<code class="descname">plot_assigned</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.plot_assigned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.plot_assigned" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a Plotly figure with the assignments overlaid
on the experimental spectrum.</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.process_catalog">
<code class="descname">process_catalog</code><span class="sig-paren">(</span><em>name</em>, <em>formula</em>, <em>catalogpath</em>, <em>auto=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.process_catalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.process_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a catalog (SPCAT) file and sweeps through the
U-line list for this experiment finding coincidences.</p>
<p>Similar to the splatalogue interface, lines are rejected
on state energy from the t_threshold attribute.</p>
<p>Each catalog entry will be weighted according to their
theoretical intensity and deviation from observation. In
automatic mode, the highest weighted transition is assigned.</p>
<p>name - str corresponding to common name of molecule
formula - str corresponding to chemical formula</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.process_lin">
<code class="descname">process_lin</code><span class="sig-paren">(</span><em>name</em>, <em>formula</em>, <em>linpath</em>, <em>auto=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.process_lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.process_lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a line file and sweeps through the U-line list.</p>
<p>Operationally, the same as the catalog and splatalogue methods,
but parses a line file instead. The differences are a lack of
filtering, since there is insufficient information in a lin
file.</p>
<p>Kwargs are passed into the assignment dictionary.</p>
<p>name - str common name of the molecule
formula - str chemical formula of the molecule
linpath - path to line file to be parsed
auto - optional bool specifying which mode to run in</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.save_session">
<code class="descname">save_session</code><span class="sig-paren">(</span><em>filepath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.save_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.save_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to save an AssignmentSession to disk.</p>
<p>The underlying mechanics are based on the joblib library,
and so there are can cross-compatibility issues particularly
when loading from different versions of Python.</p>
<dl class="docutils">
<dt>filepath - path to save the file to. By default it will go into</dt>
<dd>the sessions folder.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.search_frequency">
<code class="descname">search_frequency</code><span class="sig-paren">(</span><em>frequency</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.search_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.search_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for searching a frequency in the spectrum.
Gives information relevant to whether it’s a U-line
or assigned.</p>
<p>Raises exception error if nothing is found.</p>
<p>frequency - float corresponding to the frequency in MHz</p>
<p>slice_df - pandas dataframe containing matches</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.search_species">
<code class="descname">search_species</code><span class="sig-paren">(</span><em>formula=None</em>, <em>name=None</em>, <em>smiles=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.search_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.search_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for finding species in the assigned dataframe,
with the intention of showing where the observed frequencies
are.</p>
<p>formula - str for chemical formula lookup
name - str for common name
smiles - str for unique SMILES string</p>
<p>pandas dataframe slice with corresponding lookup</p>
</dd></dl>

<dl class="method">
<dt id="pyspectools.spectra.assignment.AssignmentSession.splat_assign_spectrum">
<code class="descname">splat_assign_spectrum</code><span class="sig-paren">(</span><em>auto=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#AssignmentSession.splat_assign_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.AssignmentSession.splat_assign_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will provide an “interface” for interactive
line assignment in a notebook environment.</p>
<p>Basic functionality is looping over a series of peaks,
which will query splatalogue for known transitions in the
vicinity. If the line is known in Splatalogue, it will
throw it into an Assignment object and flag it as known.
Conversely, if it’s not known in Splatalogue it will defer
assignment, flagging it as unassigned and dumping it into
the <cite>uline</cite> attribute.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspectools.spectra.assignment.Session">
<em class="property">class </em><code class="descclassname">pyspectools.spectra.assignment.</code><code class="descname">Session</code><span class="sig-paren">(</span><em>experiment: int</em>, <em>composition: List[str] = &lt;factory&gt;</em>, <em>temperature: float = 4.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/assignment.html#Session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.assignment.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>DataClass for a Session, which simply holds the
experiment ID, composition, and guess temperature</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.spectra.database">
<span id="pyspectools-spectra-database"></span><h1>PySpectools spectra.database<a class="headerlink" href="#module-pyspectools.spectra.database" title="Permalink to this headline">¶</a></h1>
<p>database.py</p>
<p>Routines for managing a spectral line database.</p>
</div>
<div class="section" id="module-pyspectools.spectra.parsers">
<span id="pyspectools-spectra-parsers"></span><h1>PySpectools spectra.parsers<a class="headerlink" href="#module-pyspectools.spectra.parsers" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyspectools.spectra.parsers.parse_lin">
<code class="descclassname">pyspectools.spectra.parsers.</code><code class="descname">parse_lin</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/parsers.html#parse_lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.parsers.parse_lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a line file, formatted in the SPFIT
convention.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.parsers.parse_spectrum">
<code class="descclassname">pyspectools.spectra.parsers.</code><code class="descname">parse_spectrum</code><span class="sig-paren">(</span><em>filename</em>, <em>threshold=20.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/parsers.html#parse_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.parsers.parse_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a blackchirp or QtFTM spectrum from file</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.spectra.plotting">
<span id="pyspectools-spectra-plotting"></span><h1>PySpectools spectra.plotting<a class="headerlink" href="#module-pyspectools.spectra.plotting" title="Permalink to this headline">¶</a></h1>
<p>plotting.py</p>
<p>Functions for plotting up chirp data that requires interactivity based
on Plotly.</p>
<p>The idea is to have some low level wrappers that will plot whatever data in
pandas dataframes, then have some specific higher level functions that will
plot specific stuff (e.g. artifact comparison, assignments).</p>
<dl class="function">
<dt id="pyspectools.spectra.plotting.color_iterator">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">color_iterator</code><span class="sig-paren">(</span><em>n</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#color_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.color_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple generator that will yield a different color each time.
This is primarily designed when multiple plot types are expected.</p>
<p>Input arguements:
n - number of plots
Optional kwargs are passed into generate_colors</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.define_layout">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">define_layout</code><span class="sig-paren">(</span><em>xlabel=''</em>, <em>ylabel=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#define_layout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.define_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for generating a layout for plotly.
Some degree of customization is provided, but generally sticking
with not having to fuss around with plots.</p>
<p>Input arguments:
x/ylabel - str for what the x and y labels are to be</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.generate_colors">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">generate_colors</code><span class="sig-paren">(</span><em>n</em>, <em>cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#generate_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.generate_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function for generating a colour map</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.plot_assignment">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">plot_assignment</code><span class="sig-paren">(</span><em>spec_df</em>, <em>assignments_df</em>, <em>col='Intensity'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#plot_assignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.plot_assignment" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting spectra with assignments. The assumption is that
the assignments routines are ran prior too this, and so the function
simply takes a dataframe of chosen molecules and plots them alongside
the experimental spectrum, color coded by the molecule</p>
<p>Input argument:
spec_df - dataframe holding the experimental data
assignments_df - dataframe produced from running assignments</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.plot_bar_assignments">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">plot_bar_assignments</code><span class="sig-paren">(</span><em>species_df</em>, <em>color='#fc8d62'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#plot_bar_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.plot_bar_assignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate a bar plot trace for a chemical species.
These plots will be placed in the second y axis!</p>
<p>Input arguments:
species_df - a slice of an assignments dataframe, containing only
one unique species
Optional argument color is a hex code color; if nothing is given
it just defaults to whatever</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.plot_catchirp">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">plot_catchirp</code><span class="sig-paren">(</span><em>chirpdf</em>, <em>catfiles=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#plot_catchirp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.plot_catchirp" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to perform interactive analysis with a chirp spectrum, as well
as any reference .cat files you may want to provide.
This is not designed to replace SPECData analysis, but simply to
perform some interactive viewing of the data.</p>
<p>The argument <cite>catfiles</cite> is supplied as a dictionary; where the keys are
the names of the species, and the items are the paths to the .cat files</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.plot_column">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">plot_column</code><span class="sig-paren">(</span><em>dataframe</em>, <em>col</em>, <em>name=None</em>, <em>color=None</em>, <em>layout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#plot_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.plot_column" title="Permalink to this definition">¶</a></dt>
<dd><p>A low level function for plotting a specific column of
data in a pandas dataframe. This will assume that there
is a column named “Frequency” in the dataframe.</p>
<p>If a layout is not supplied, then the function will
return a Plotly scatter object to be combined with other
data. If a layout is given, then the data will be plot
up directly.</p>
<p>Input arguments:
dataframe - pandas dataframe object
col - str specifying the column used to plot
layout - optional argument; if specified a plotly plot will be
produced.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.plot_df">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">plot_df</code><span class="sig-paren">(</span><em>dataframe</em>, <em>cols=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#plot_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.plot_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that wraps around the lower level function plot_column.
Will plot every column in a dataframe against the Frequency, unless
specific column names are provided.</p>
<p>Input arguments:
dataframe - pandas dataframe object, with every column as intensity
except “Frequency”
cols - NoneType or tuple-like: if None, every column is plotted.
Alternatively, an iterable is provided to specify which columns are
plotted.
Optional arguments are passed into define_layout, which will define
the axis labels, or into the color map generation</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.spectra.plotting.save_plot">
<code class="descclassname">pyspectools.spectra.plotting.</code><code class="descname">save_plot</code><span class="sig-paren">(</span><em>fig</em>, <em>filename</em>, <em>js=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/spectra/plotting.html#save_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.spectra.plotting.save_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for exporting a plotly figure with interactivity.
This method does inject the plotly.js code by default, and so will
result in relatively large files. Use <cite>save_html</cite> instead.</p>
</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">PySpecTools</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Kelvin Lee.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>