<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>PySpecTools :: pyspectools.mmw package</title>
  

  <link rel="icon" type="image/png" sizes="32x32" href="static/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="static/img/favicon-16x16.png">
        <link rel="index" title="Index"
              href="genindex.html"/>

  <link rel="stylesheet" href="static/css/insegel.css"/>

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'',
        VERSION:'4.1.5',
        LANGUAGE:'None',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
    };
  </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/language_data.js"></script>

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script>

</head>

<body>
  <div id="insegel-container">
    <header>
      <div id="logo-container">
          
          <a href="index.html"><img src="static/img/logo.svg"></a>
          

      </div>
      <div id="project-container">
        <h1>PySpecTools Documentation</h1>
      </div>
    </header>

    <div id="content-container">

      <div id="main-content-container">
        <div id="main-content-header">
          <h1>pyspectools.mmw package</h1>
        </div>
        <div id="main-content">
          
  <div class="section" id="pyspectools-mmw-package">
<h1>pyspectools.mmw package<a class="headerlink" href="#pyspectools-mmw-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyspectools.mmw.fft_routines">
<span id="pyspectools-mmw-fft-routines-module"></span><h2>pyspectools.mmw.fft_routines module<a class="headerlink" href="#module-pyspectools.mmw.fft_routines" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyspectools.mmw.fft_routines.butter_filter">
<code class="descclassname">pyspectools.mmw.fft_routines.</code><code class="descname">butter_filter</code><span class="sig-paren">(</span><em>data</em>, <em>cutoff</em>, <em>fs</em>, <em>filter_type</em>, <em>order=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/fft_routines.html#butter_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.fft_routines.butter_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.fft_routines.fft_filter">
<code class="descclassname">pyspectools.mmw.fft_routines.</code><code class="descname">fft_filter</code><span class="sig-paren">(</span><em>ydata</em>, <em>window_function=None</em>, <em>cutoff=None</em>, <em>sample_rate=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/fft_routines.html#fft_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.fft_routines.fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Fourier filter implementation.</p>
<p>Takes signal data in the frequency domain, and transforms into the
time domain where slices are taken off.</p>
<p>Various window functions can be applied, including stock and custom
filters that I have implemented. One in particular is the house
filter, which is considered the “gold standard”.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.fft_routines.gen_butter_filter">
<code class="descclassname">pyspectools.mmw.fft_routines.</code><code class="descname">gen_butter_filter</code><span class="sig-paren">(</span><em>cutoff</em>, <em>fs</em>, <em>filter_type</em>, <em>order=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/fft_routines.html#gen_butter_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.fft_routines.gen_butter_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a specified Butterworth filter.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.fft_routines.house_filter">
<code class="descclassname">pyspectools.mmw.fft_routines.</code><code class="descname">house_filter</code><span class="sig-paren">(</span><em>size</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/fft_routines.html#house_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.fft_routines.house_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the “gold standard” filter.</p>
<p>This window is designed to produce low sidelobes
for Fourier filters.</p>
<p>In essence it resembles a sigmoid function that
smoothly goes between zero and one, from short
to long time.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.mmw.interpolation">
<span id="pyspectools-mmw-interpolation-module"></span><h2>pyspectools.mmw.interpolation module<a class="headerlink" href="#module-pyspectools.mmw.interpolation" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyspectools.mmw.interpolation.calc_shep_interp">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">calc_shep_interp</code><span class="sig-paren">(</span><em>dataframes</em>, <em>xnew</em>, <em>col='Intensity'</em>, <em>xrange=10.0</em>, <em>p=4.0</em>, <em>threshold=1.0</em>, <em>npoints=15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#calc_shep_interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.calc_shep_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function for calculating the Shepard interpolation for
a given set of existing data, and an array corresponding
to the new set of x data.</p>
<p>dataframes - a list comprising pandas DataFrames, containing x/y data with
column names [“Frequency”, “Intensity”]
xnew - the new x values to interpolate into. Use np.arange/np.linspace to
generate.
xrange - the frequency radius (in units of whatever frequency units are in data)
to search for neighbours. Also defines the rate at which the neighbourlist is updated.
p - the decay rate of the inverse distance weighting; should be even values.
threshold - minimum weight value to be considered in the interpolation
npoints - the maximum number of data points to use in the interpolation; smaller
numbers mean crappy interpolation, larger means expensive.</p>
<p>Returns the new y values</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.interpolation.find_nearest">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">find_nearest</code><span class="sig-paren">(</span><em>dataframes</em>, <em>x</em>, <em>npoints=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#find_nearest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will take a list of dataframes, and
return slices of the dataframes containing a specified
number of closest points.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.interpolation.find_nearest_nieu">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">find_nearest_nieu</code><span class="sig-paren">(</span><em>dataframes</em>, <em>x</em>, <em>xrange=3.0</em>, <em>npoints=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#find_nearest_nieu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.find_nearest_nieu" title="Permalink to this definition">¶</a></dt>
<dd><p>New function that will return only data that is within a
specified range, and within that the closest values.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.interpolation.idw">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">idw</code><span class="sig-paren">(</span><em>x</em>, <em>xn</em>, <em>p=6</em>, <em>threshold=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#idw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.idw" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse-distance weighting function
For a given value of x with known data, and the interpolating
x (xn), return the weighting value.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.interpolation.shep_interp">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">shep_interp</code><span class="sig-paren">(</span><em>dataframes</em>, <em>xn</em>, <em>col='Intensity'</em>, <em>p=6</em>, <em>threshold=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#shep_interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.shep_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Shepard interpolation of a point</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.interpolation.vidw">
<code class="descclassname">pyspectools.mmw.interpolation.</code><code class="descname">vidw</code><span class="sig-paren">(</span><em>x</em>, <em>xn</em>, <em>p=6</em>, <em>threshold=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/interpolation.html#vidw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.interpolation.vidw" title="Permalink to this definition">¶</a></dt>
<dd><p>Vectorized form of the inverse-distance weighting function</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.mmw.mmw_analysis">
<span id="pyspectools-mmw-mmw-analysis-module"></span><h2>pyspectools.mmw.mmw_analysis module<a class="headerlink" href="#module-pyspectools.mmw.mmw_analysis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.batch_interpolate">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">batch_interpolate</code><span class="sig-paren">(</span><em>files</em>, <em>datapoints=50000</em>, <em>zeeman_on=None</em>, <em>window_function=None</em>, <em>pass_filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#batch_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.batch_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for batch processing multiple scan files, and concetanates them
together to generate a single, interactive spectrum.</p>
<p>Takes input argument files as a list of filepaths corresponding to scans
that are (generally) without Zeeman. The optional argument, zeeman_on,
is a list of filepaths corresponding to scans with Zeeman on.</p>
<p>All of the scans will be processed with the same window functions and
cut offs, so be sure to optimize them before batch processing.</p>
<p>Returns a dataframe with up to three columns: Zeeman off/on, and off - on.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.batch_plot">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">batch_plot</code><span class="sig-paren">(</span><em>files</em>, <em>window_function=None</em>, <em>pass_filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#batch_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.batch_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.batch_shepard">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">batch_shepard</code><span class="sig-paren">(</span><em>files</em>, <em>stepsize=0.1</em>, <em>xrange=10.0</em>, <em>p=4.0</em>, <em>threshold=0.1</em>, <em>npoints=15</em>, <em>window_function=None</em>, <em>pass_filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#batch_shepard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.batch_shepard" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine for performing mass interpolation using Shepard’s interpolation method
on mmw data. Input is a list of files, and parameters used to interpolate and
to filter the data.</p>
<p>Stepsize is given in units of MHz.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.fit_chunk">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">fit_chunk</code><span class="sig-paren">(</span><em>dataframe</em>, <em>min_freq</em>, <em>max_freq</em>, <em>frequencies</em>, <em>ycol='Field off'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#fit_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.fit_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will fit second-derivative lineprofiles to chunks
of a spectrum.</p>
<p>The full spectrum is provided as a dataframe, and uses pandas
to slice the minimum and maximum frequencies. The frequencies
are provided as a list of center frequencies to fit.</p>
<p>An optional argument, ycol, is used to specify which dataframe
column to use.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.fit_lines">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">fit_lines</code><span class="sig-paren">(</span><em>dataframe</em>, <em>frequencies</em>, <em>name</em>, <em>window_length=10.0</em>, <em>ycol='Field off'</em>, <em>off_dataframe=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#fit_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.fit_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the fit_chunk function, for when you want to
try and fit many lines in a catalog.</p>
<p>The input arguments are the survey dataframe, a list of
center frequencies you want to try and fit, the name of
the species. Optional argument is the name of column you
want to use for the intensities.</p>
<p>The function will iterate through each center frequency
and try to fit it.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.interp_mmw">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">interp_mmw</code><span class="sig-paren">(</span><em>files</em>, <em>nelements=10000</em>, <em>window_function=None</em>, <em>cutoff=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#interp_mmw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.interp_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will process archival millimeter-wave data
by providing a list of filepaths.</p>
<p>The function will parse the data out of each file, and
produce a plot that is stitched together.</p>
<p>The first step is to read in all the data, and append
the parsed data into full_freq and full_int, corresponding
to the experimental frequency and intensities. This is
used to then determine the limits to the x axis for plotting.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.open_mmw">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">open_mmw</code><span class="sig-paren">(</span><em>filepath</em>, <em>window_function=None</em>, <em>pass_filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#open_mmw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.open_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for opening and processing a single millimeter
wave data file.</p>
<p>Returns a pandas dataframe containing Frequency and
Intensity information.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.mmw_analysis.parse_data">
<code class="descclassname">pyspectools.mmw.mmw_analysis.</code><code class="descname">parse_data</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/mmw_analysis.html#parse_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.mmw_analysis.parse_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for parsing data from a millimeter-wave
data file.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.mmw.plotting_func">
<span id="pyspectools-mmw-plotting-func-module"></span><h2>pyspectools.mmw.plotting_func module<a class="headerlink" href="#module-pyspectools.mmw.plotting_func" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyspectools.mmw.plotting_func.id_survey">
<code class="descclassname">pyspectools.mmw.plotting_func.</code><code class="descname">id_survey</code><span class="sig-paren">(</span><em>frequency</em>, <em>intensity</em>, <em>catdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/plotting_func.html#id_survey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.plotting_func.id_survey" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting predicted lines as stick spectra
on top of a broadband survey spectrum.</p>
<p>Frequency and intensity are 1D arrays of the spectrum
frequency and intensity.</p>
<p>catdict is a dictionary with keys corresponding to
the name of the molecule, and values corresponding
to dataframes of the parsed .cat file.</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.plotting_func.plot_spectrum">
<code class="descclassname">pyspectools.mmw.plotting_func.</code><code class="descname">plot_spectrum</code><span class="sig-paren">(</span><em>dataframe</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/plotting_func.html#plot_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.plotting_func.plot_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to plot a dataframe using Plotly.</p>
<p>Uses colorlover to generate palettes.</p>
<p>Args: dataframe - pandas dataframe containing a frequency
column. Every other column is treated as an intensity column</p>
</dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.plotting_func.save_plot">
<code class="descclassname">pyspectools.mmw.plotting_func.</code><code class="descname">save_plot</code><span class="sig-paren">(</span><em>fig</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/plotting_func.html#save_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.plotting_func.save_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyspectools.mmw.plotting_func.static_comparison">
<code class="descclassname">pyspectools.mmw.plotting_func.</code><code class="descname">static_comparison</code><span class="sig-paren">(</span><em>frequencies</em>, <em>sample_on_df</em>, <em>sample_off_df</em>, <em>window_size=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/mmw/plotting_func.html#static_comparison"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.mmw.plotting_func.static_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for plotting the sample on-off spectra side-by-side.
Takes a list of frequencies, which will be</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.mmw">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyspectools.mmw" title="Permalink to this headline">¶</a></h2>
</div>
</div>


        </div>
      </div>

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
            <input type="text" name="q" placeholder="Search..." />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">

          
  
    
  
  
    <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>

  


        </div>

        

      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            
                <li class="footer-element">
                    
                        <a href="_sources/pyspectools.mmw.rst.txt" rel="nofollow"> source</a>
                    
                </li>
            

            

            
        </ul>
        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/Autophagy/insegel">Insegel</a>

        </div>
    </div>

    <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

    <script type="text/javascript">
      $("#menu-toggle").click(function() {
        $("#menu-toggle").toggleClass("toggled");
        $("#side-menu-container").slideToggle(300);
      });
    </script>

</footer> 

</div>

</body>
</html>
