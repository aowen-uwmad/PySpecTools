<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyspectools package &#8212; PySpecTools 4.4.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyspectools.astro package" href="pyspectools.astro.html" />
    <link rel="prev" title="PySpecTools" href="modules.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          PySpecTools</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">PySpecTools FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.spectra.html"><cite>Spectra</cite> Module</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pyspectools package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyspectools.autofit">pyspectools.autofit module</a></li>
<li><a class="reference internal" href="#module-pyspectools.database">Builtin database module</a></li>
<li><a class="reference internal" href="#module-pyspectools.doubleresonance">Double resonance analysis</a></li>
<li><a class="reference internal" href="#module-pyspectools.figurefactory">Figure factory module</a></li>
<li><a class="reference internal" href="#module-pyspectools.fitting">Fitting routines</a></li>
<li><a class="reference internal" href="#module-pyspectools.ftmw_analysis">Cavity FTMW module</a></li>
<li><a class="reference internal" href="#spectroscopic-lineshapes-module">Spectroscopic lineshapes module</a></li>
<li><a class="reference internal" href="#module-pyspectools.parsers">Standard parsers module</a></li>
<li><a class="reference internal" href="#module-pyspectools.pypickett">PyPickett module</a></li>
<li><a class="reference internal" href="#module-pyspectools.routines">Generic routines module</a></li>
<li><a class="reference internal" href="#module-pyspectools.units">Unit conversions</a></li>
<li><a class="reference internal" href="#module-pyspectools">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="modules.html" title="Previous Chapter: PySpecTools"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PySpecTools</span>
    </a>
  </li>
  <li>
    <a href="pyspectools.astro.html" title="Next Chapter: pyspectools.astro package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">pyspectools.a... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/pyspectools.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="pyspectools-package">
<h1>pyspectools package<a class="headerlink" href="#pyspectools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.astro.html">pyspectools.astro package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.astro.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.astro.html#module-pyspectools.astro.analysis">pyspectools.astro.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.astro.html#module-pyspectools.astro.conversions">pyspectools.astro.conversions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.astro.html#module-pyspectools.astro.radiative">pyspectools.astro.radiative module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.astro.html#module-pyspectools.astro">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.fast.html">pyspectools.fast package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.fast.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.fast.html#module-pyspectools.fast.filters">pyspectools.fast.filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.fast.html#module-pyspectools.fast.lineshapes">pyspectools.fast.lineshapes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.fast.html#module-pyspectools.fast.routines">pyspectools.fast.routines module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.fast.html#module-pyspectools.fast">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.mmw.html">pyspectools.mmw package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#module-pyspectools.mmw.fft_routines">pyspectools.mmw.fft_routines module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#module-pyspectools.mmw.interpolation">pyspectools.mmw.interpolation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#module-pyspectools.mmw.mmw_analysis">pyspectools.mmw.mmw_analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#module-pyspectools.mmw.plotting_func">pyspectools.mmw.plotting_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.mmw.html#module-pyspectools.mmw">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.models.html">pyspectools.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.models.html#module-pyspectools.models.classes">pyspectools.models.classes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.models.html#module-pyspectools.models.torch_models">pyspectools.models.torch_models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.models.html#module-pyspectools.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.qchem.html">pyspectools.qchem package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.analysis">pyspectools.qchem.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.extrapolation">pyspectools.qchem.extrapolation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.heat_analysis">pyspectools.qchem.heat_analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.multiwell">pyspectools.qchem.multiwell module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.parsers">pyspectools.qchem.parsers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem.utils">pyspectools.qchem.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.qchem.html#module-pyspectools.qchem">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyspectools.spectra.html"><cite>Spectra</cite> Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.spectra.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.spectra.html#module-pyspectools.spectra.analysis">pyspectools.spectra.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.spectra.html#module-pyspectools.spectra.assignment">pyspectools.spectra.assignment module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyspectools.spectra.html#module-pyspectools.spectra">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyspectools.autofit">
<span id="pyspectools-autofit-module"></span><h2>pyspectools.autofit module<a class="headerlink" href="#module-pyspectools.autofit" title="Permalink to this headline">¶</a></h2>
<p>Routines for performing automatic fitting using
SPFIT/SPCAT.</p>
<dl class="py class">
<dt id="pyspectools.autofit.Autofit">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.autofit.</code><code class="sig-name descname">Autofit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for an Autofit object which handles
all of the formatting and executable calls.</p>
<dl class="py class">
<dt id="pyspectools.autofit.Autofit.Line">
<em class="property">class </em><code class="sig-name descname">Line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">unc</span><span class="o">=</span><span class="default_value">0.002</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.Line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.Line" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Line object that holds the frequency and
assignments. Has access to methods for
formatting.</p>
<dl class="py method">
<dt id="pyspectools.autofit.Autofit.Line.format_lin">
<code class="sig-name descname">format_lin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.Line.format_lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.Line.format_lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for formatting the line into a .lin
file format.
12I3,freeform
QN,Freq,Err,Wt</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.autofit.Autofit.Line.set_assignments">
<code class="sig-name descname">set_assignments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assignment</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.Line.set_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.Line.set_assignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for setting up the quantum number
assignments.</p>
<p>The assignments come in an OrderedDict such that
when we pipe the data back out we want the upper
levels to come out first.</p>
<dl class="simple">
<dt>assignment- key/value pairs correspond to the quantum</dt><dd><p>number and value. Must be an OrderedDict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="pyspectools.autofit.Autofit.delta_no">
<code class="sig-name descname">delta_no</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">N</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.delta_no"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.delta_no" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to generate a lower state quantum
number based on the selection rule provided.</p>
<p>The value must also be greater or equal to zero.</p>
<p>For example, delta N = -1/0
delta K = -1, 0, 1
delta F = -1, 0, 1</p>
<p>value - integer value of upper state quantum number
N - bool arg specifying whether the quantum number is N</p>
<p>lower_qno - value for lower quantum number</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.autofit.Autofit.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method to initialize an Autofit obj
by reading in a YAML syntax file.</p>
<p>filepath - str specifying path to yaml file</p>
<p>autofit obj</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.autofit.Autofit.generate_qnos">
<code class="sig-name descname">generate_qnos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/autofit.html#Autofit.generate_qnos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.autofit.Autofit.generate_qnos" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for generating random quantum numbers based on
what is allowed.</p>
<p>These rules are hardcoded because certain aspects are
already pre-ordained: e.g.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyspectools.database">
<span id="builtin-database-module"></span><h2>Builtin database module<a class="headerlink" href="#module-pyspectools.database" title="Permalink to this headline">¶</a></h2>
<p>database.py</p>
<p>Routines for managing a spectral line database.</p>
<p>TODO - set up routines for a persistent database</p>
<dl class="py class">
<dt id="pyspectools.database.SpectralCatalog">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.database.</code><code class="sig-name descname">SpectralCatalog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dbpath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tinydb.database.TinyDB</span></code></p>
<p>Grand unified experimental catalog. Stores assignment and uline information
across the board.</p>
<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.add_catalog">
<code class="sig-name descname">add_catalog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">catalog_path</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">formula</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.add_catalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.add_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a SPCAT catalog file into the database. Creates independent Transition objects
from each line of the catalog file. Kwargs are passed into the Transition object,
which will allow additional settings for the Transition object to be accessed.
:param catalog_path:
:param name:
:param formula:
:param kwargs:
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.add_entry">
<code class="sig-name descname">add_entry</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assignment</span></em>, <em class="sig-param"><span class="n">dup_check</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.add_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.add_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>This function adds an Transition object to an existing database. The method will
check for duplicates before adding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- Transition object</strong> (<em>assignment</em>) – Reference to an Transition object</p></li>
<li><p><strong>- bool</strong><strong>, </strong><strong>optional</strong> (<em>dup_check</em>) – If True (default), will check to make sure the Transition object doesn’t already exist in
the database.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.remove_experiment">
<code class="sig-name descname">remove_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">exp_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.remove_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.remove_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all entries based on an experiment ID.
:param exp_id: int, experiment ID</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.remove_molecule">
<code class="sig-name descname">remove_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.remove_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.remove_molecule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.search_experiment">
<code class="sig-name descname">search_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">exp_id</span></em>, <em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.search_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.search_experiment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.search_formula">
<code class="sig-name descname">search_formula</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">formula</span></em>, <em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.search_formula"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.search_formula" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.search_frequency">
<code class="sig-name descname">search_frequency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">freq_prox</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">freq_abs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.search_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.search_frequency" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> – float, center frequency to search for in the database</p></li>
<li><p><strong>freq_prox</strong> – float, search range tolerance. If freq_abs is True, the absolute value is used (in MHz).
Otherwise, freq_prox is a decimal percentage of the frequency.</p></li>
<li><p><strong>freq_abs</strong> – bool, dictates whether the absolute value of freq_prox is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.database.SpectralCatalog.search_molecule">
<code class="sig-name descname">search_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#SpectralCatalog.search_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.SpectralCatalog.search_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for a molecule in the database based on its name (not formula!).
Wraps the _search_field method, which will return None if nothing is found, or either a
pandas dataframe or a list of Transition objects
:param name: str, name (not formula) of the molecule to search for
:param dataframe: bool, if True, returns a pandas dataframe
:return: matches: a dataframe or list of Transition objects that match the search name</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.database.TheoryCatalog">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.database.</code><code class="sig-name descname">TheoryCatalog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dbpath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/database.html#TheoryCatalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.database.TheoryCatalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tinydb.database.TinyDB</span></code></p>
<p>Grand unified theory catalog.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.doubleresonance">
<span id="double-resonance-analysis"></span><h2>Double resonance analysis<a class="headerlink" href="#module-pyspectools.doubleresonance" title="Permalink to this headline">¶</a></h2>
<p>Routines for fitting double resonance data</p>
<dl class="py function">
<dt id="pyspectools.doubleresonance.fit_dr">
<code class="sig-prename descclassname">pyspectools.doubleresonance.</code><code class="sig-name descname">fit_dr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">col</span><span class="o">=</span><span class="default_value">'Average'</span></em>, <em class="sig-param"><span class="n">baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#fit_dr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.fit_dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for fitting double resonance data.</p>
<p>dataframe - pandas dataframe containing</p>
<p>col - str denoting which column to use for fitting.
baseline - boolean denoting whether a linear baseline is fit
guess - dict for fitting parameters; this is passed into</p>
<blockquote>
<div><p>the fit directly and so must match the lmfit convention.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.doubleresonance.init_dr_model">
<code class="sig-prename descclassname">pyspectools.doubleresonance.</code><code class="sig-name descname">init_dr_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">baseline</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#init_dr_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.init_dr_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to serialize a Model object for DR fits.
Defaults to a Gaussian line shape, but the option to include
a linear offset is available.</p>
<p>Additionally, if a guess is provided in the
lmfit convention then it will be incorporated.</p>
<p>baseline - boolean indicating if linear offset is included
guess - nested dict with keys corresponding to parameter name</p>
<blockquote>
<div><p>and values corresponding to dicts with key/value
indicating the parameter value, range, and constraints</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.doubleresonance.parse_data">
<code class="sig-prename descclassname">pyspectools.doubleresonance.</code><code class="sig-name descname">parse_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#parse_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.parse_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a DR file. When there are multiple columns present
in the file, this is interpreted as multiple channels being used to
monitor during the DR experiment. In this case, we do the analysis on
the co-average of these columns.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.doubleresonance.peak_detect">
<code class="sig-prename descclassname">pyspectools.doubleresonance.</code><code class="sig-name descname">peak_detect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">col</span><span class="o">=</span><span class="default_value">'Average'</span></em>, <em class="sig-param"><span class="n">interpolate</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/doubleresonance.html#peak_detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.doubleresonance.peak_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine for peak detection to provide an initial
guess for the center frequency.</p>
<p>The algorithm assumes that the ten smallest intensities
corresponds to where the depletion approximately is.</p>
<p>By default, a cubic spline is performed on the intensities
so that a finer grid of points gives a better determination
of the center frequency.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.figurefactory">
<span id="figure-factory-module"></span><h2>Figure factory module<a class="headerlink" href="#module-pyspectools.figurefactory" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyspectools.figurefactory.add_image">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">add_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">zoom</span><span class="o">=</span><span class="default_value">0.15</span></em>, <em class="sig-param"><span class="n">position</span><span class="o">=</span><span class="default_value">[0.0, 0.0]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#add_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.add_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to add an image annotation to a specified axis.</p>
<p>Takes the matplotlib axis and filepath to the image as input,
and optional arguments for the scaling (zoom) and position of
the image in axis units.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.calc_vibE">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">calc_vibE</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quant_nums</span></em>, <em class="sig-param"><span class="n">vibrations</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#calc_vibE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.calc_vibE" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will calculate a 1D array of
vibrational energies, based on a nested list
of quantum numbers and a list of vibrational
frequencies.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.cfa_cmap">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">cfa_cmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#cfa_cmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.cfa_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a Matplotlib colormap with the CfA branding colors. Performs a linear interpolation from the CfA red to
the so-called CfA violet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- int</strong> (<em>nsteps</em>) – Number of steps to take in the interpolation; i.e. number of colors to return</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LinearSegementedColormap instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.color_iterator">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">color_iterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#color_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.color_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple generator that will yield a different color each time.
This is primarily designed when multiple plot types are expected.</p>
<p>Input arguements:
n - number of plots
Optional kwargs are passed into generate_colors</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.define_layout">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">define_layout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xlabel</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#define_layout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.define_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for generating a layout for plotly.
Some degree of customization is provided, but generally sticking
with not having to fuss around with plots.</p>
<p>Input arguments:
x/ylabel - str for what the x and y labels are to be</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.dr_network_diagram">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">dr_network_diagram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">connections</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#dr_network_diagram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.dr_network_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Use NetworkX to create a graph with nodes corresponding to cavity
frequencies, and vertices as DR connections.
The color map can be specified by passing kwargs.
:param connections: list of 2-tuples corresponding to pairs of connections
:return</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.format_ticklabels">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">format_ticklabels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#format_ticklabels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.format_ticklabels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.generate_colors">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">generate_colors</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">hex=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#generate_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.generate_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a linearly spaced color series using a colormap from
Matplotlib. The colors can be returned as either RGB values
or as hex-codes using the <cite>hex</cite> flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of colours to generate</p></li>
<li><p><strong>cmap</strong> (str or <cite>matplotlib.colors.LinearSegementedColomap</cite>, optional) – Specified colormap to interpolate. If a str is provided, the function
will try to look for it in the available matplotlib colormaps.</p></li>
<li><p><strong>hex</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, hex colors are returned. Otherwise, RGB values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of hex or RGB codes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>colors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.generate_x_coord">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">generate_x_coord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quant_nums</span></em>, <em class="sig-param"><span class="n">energies</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#generate_x_coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.generate_x_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate the x coordinate for plotting
based on the quantum numbers specified.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.init_bokeh_figure">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">init_bokeh_figure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yml_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#init_bokeh_figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.init_bokeh_figure" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Bokeh Figure object. This code is fairly low level, and is
used simply as a matter of convenience for supplying a default theme even
without the user explicitly providing one.</p>
<p>Kwargs are passed into the creation of the figure, and so further
customization like title, axis limits, etc. should be supplied this way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>yml_path</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If None, uses the PySpecTools default bokeh styling. If a str is
provided then it should correspond to the filepath to a YAML file.</p></li>
<li><p><strong>kwargs</strong> – Kwargs are passed into the creation of the Figure object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Bokeh Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.init_plotly_subplot">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">init_plotly_subplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nrows</span></em>, <em class="sig-param"><span class="n">ncols</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#init_plotly_subplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.init_plotly_subplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Plotly subplot.
:param nrows: number of rows for the subplot
:param ncols: number of columns for the subplot
:return: plotly FigureWidget object</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.make_elevel_plot">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">make_elevel_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cat_dict</span></em>, <em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">color</span></em>, <em class="sig-param"><span class="n">maxE</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#make_elevel_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.make_elevel_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>make_elevel_plot is used to create energy level diagrams
with Matplotlib axis objects. This is considered slightly
lower level: you should call the higher level wrapper functions
like vib_energy_diagram instead!</p>
<p>The function will loop over every transition that has
been categorized/binned into an x-axis index, and sub-
sequently plot each x-bin individually.</p>
<p>The input arguments are:</p>
<p>cat_dict: dict-like with keys as the x-axis values, and
the items are dictionaries containing the energy and
quantum number configuration.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.make_pes">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">make_pes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">energies</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#make_pes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.make_pes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create a smooth PES, where stationary
points are connected.</p>
<p>Basically makes a linearly spaced x array which
pads x-axis density to create the horizontal line
for the stationary points</p>
<p>Optional arguments are how many x-points to
pad with on either side.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.no_scientific">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">no_scientific</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#no_scientific"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.no_scientific" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.overlay_dr_spectrum">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">overlay_dr_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">progressions</span></em>, <em class="sig-param"><span class="n">freq_col</span><span class="o">=</span><span class="default_value">'Frequency'</span></em>, <em class="sig-param"><span class="n">int_col</span><span class="o">=</span><span class="default_value">'Intensity'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#overlay_dr_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.overlay_dr_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.pandas_bokeh_table">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">pandas_bokeh_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">html</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#pandas_bokeh_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.pandas_bokeh_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Pandas DataFrame to a Bokeh DataTable object.
Columns will be automatically generated based on the DataFrame keys.
The <cite>html</cite> flag can be used to specify whether or not an HTML representation is returned.</p>
<p>Additional kwargs are passed into the <cite>file_html</cite> function, and is only used when <cite>html</cite>
is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas dataframe</em>) – Pandas DataFrame to convert into a DataTable object</p></li>
<li><p><strong>html</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, function will return a string of the HTML code for embedding</p></li>
<li><p><strong>kwargs</strong> – Additional kwargs are passed into the HTML conversion</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataTable object if html is False, otherwise str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.plot_assignment">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">plot_assignment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec_df</span></em>, <em class="sig-param"><span class="n">assignments_df</span></em>, <em class="sig-param"><span class="n">col</span><span class="o">=</span><span class="default_value">'Intensity'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#plot_assignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.plot_assignment" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting spectra with assignments. The assumption is that
the assignments routines are ran prior too this, and so the function
simply takes a dataframe of chosen molecules and plots them alongside
the experimental spectrum, color coded by the molecule</p>
<p>Input argument:
spec_df - dataframe holding the experimental data
assignments_df - dataframe produced from running assignments</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.plot_bar_assignments">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">plot_bar_assignments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">species_df</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'#fc8d62'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#plot_bar_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.plot_bar_assignments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate a bar plot trace for a chemical species.
These plots will be placed in the second y axis!</p>
<p>Input arguments:
species_df - a slice of an assignments dataframe, containing only
one unique species
Optional argument color is a hex code color; if nothing is given
it just defaults to whatever</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.plot_catchirp">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">plot_catchirp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chirpdf</span></em>, <em class="sig-param"><span class="n">catfiles</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#plot_catchirp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.plot_catchirp" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to perform interactive analysis with a chirp spectrum, as well
as any reference .cat files you may want to provide.
This is not designed to replace SPECData analysis, but simply to
perform some interactive viewing of the data.</p>
<p>The argument <cite>catfiles</cite> is supplied as a dictionary; where the keys are
the names of the species, and the items are the paths to the .cat files</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.plot_column">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">plot_column</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">col</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#plot_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.plot_column" title="Permalink to this definition">¶</a></dt>
<dd><p>A low level function for plotting a specific column of
data in a pandas dataframe. This will assume that there
is a column named “Frequency” in the dataframe.</p>
<p>If a layout is not supplied, then the function will
return a Plotly scatter object to be combined with other
data. If a layout is given, then the data will be plot
up directly.</p>
<p>Input arguments:
dataframe - pandas dataframe object
col - str specifying the column used to plot
layout - optional argument; if specified a plotly plot will be
produced.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.plot_df">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">plot_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">cols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#plot_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.plot_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that wraps around the lower level function plot_column.
Will plot every column in a dataframe against the Frequency, unless
specific column names are provided.</p>
<p>Input arguments:
dataframe - pandas dataframe object, with every column as intensity
except “Frequency”
cols - NoneType or tuple-like: if None, every column is plotted.
Alternatively, an iterable is provided to specify which columns are
plotted.
Optional arguments are passed into define_layout, which will define
the axis labels, or into the color map generation</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.save_plot">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">save_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">js</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#save_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.save_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for exporting a plotly figure with interactivity.
This method does inject the plotly.js code by default, and so will
result in relatively large files. Use <cite>save_html</cite> instead.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.stacked_plot">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">stacked_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">freq_range</span><span class="o">=</span><span class="default_value">0.002</span></em>, <em class="sig-param"><span class="n">freq_col</span><span class="o">=</span><span class="default_value">'Frequency'</span></em>, <em class="sig-param"><span class="n">int_col</span><span class="o">=</span><span class="default_value">'Intensity'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#stacked_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.stacked_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Loomis-Wood style plot via a list of frequencies, and a broadband
spectrum. The keyword freq_range will use a percentage of the center
frequency to extend the frequency range that gets plotted.
:param dataframe: pandas DataFrame
:param frequencies: iterable with float frequencies to use as centers
:param freq_range: decimal percentage to specify the range to plot
:param freq_col: str name for the column to use as the frequency axis
:param int_col: str name for the column to use as the intensity axis
:return fig: Plotly FigureWidget with the subplots</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.strip_spines">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">strip_spines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spines</span></em>, <em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#strip_spines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.strip_spines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.figurefactory.vib_energy_diagram">
<code class="sig-prename descclassname">pyspectools.figurefactory.</code><code class="sig-name descname">vib_energy_diagram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quant_nums</span></em>, <em class="sig-param"><span class="n">vibrations</span></em>, <em class="sig-param"><span class="n">maxV</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">maxE</span><span class="o">=</span><span class="default_value">3000.0</span></em>, <em class="sig-param"><span class="n">useFull</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">imagesize</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/figurefactory.html#vib_energy_diagram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.figurefactory.vib_energy_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will generate a vibrational energy diagram.</p>
<p>This function wraps the make_elevel_plot function!</p>
<p>Input arguments are</p>
<p>quant_nums: A 2D numpy array of quantum numbers, where each row is
a single configuration.
vibrations: A list of vibrational frequencies.
maxV: The maximum quanta for considering predicted frequencies.
maxE: Maximum energy for plotting.
useFull: Boolean for flagging whether predict frequencies are plotted.
image: String-like for specifying path to an image.</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.fitting">
<span id="fitting-routines"></span><h2>Fitting routines<a class="headerlink" href="#module-pyspectools.fitting" title="Permalink to this headline">¶</a></h2>
<p>Wrapper functions for lmfit.</p>
<p>Each module of PySpectools should use these functions
when fitting is required, rather than rewrite for each
purpose.</p>
<dl class="py class">
<dt id="pyspectools.fitting.BJModel">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">BJModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#BJModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.BJModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspectools.fitting.PySpecModel" title="pyspectools.fitting.PySpecModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspectools.fitting.PySpecModel</span></code></a></p>
<p>Model for fitting prolate/linear molecules.</p>
</dd></dl>

<dl class="py class">
<dt id="pyspectools.fitting.FirstDerivLorentzian_Model">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">FirstDerivLorentzian_Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#FirstDerivLorentzian_Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.FirstDerivLorentzian_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspectools.fitting.PySpecModel" title="pyspectools.fitting.PySpecModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspectools.fitting.PySpecModel</span></code></a></p>
<p>Child class of the PySpecModel, which in itself inherits from the <cite>lmfit</cite> <cite>Models</cite> class.
Gives the first derivative Lorentzian line shape profile for fitting.</p>
</dd></dl>

<dl class="py class">
<dt id="pyspectools.fitting.PairGaussianModel">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">PairGaussianModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#PairGaussianModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.PairGaussianModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspectools.fitting.PySpecModel" title="pyspectools.fitting.PySpecModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspectools.fitting.PySpecModel</span></code></a></p>
<dl class="py method">
<dt id="pyspectools.fitting.PairGaussianModel.fit_pair">
<code class="sig-name descname">fit_pair</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#PairGaussianModel.fit_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.PairGaussianModel.fit_pair" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.fitting.PySpecModel">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">PySpecModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#PySpecModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.PySpecModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="pyspectools.fitting.SecDerivLorentzian_Model">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">SecDerivLorentzian_Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#SecDerivLorentzian_Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.SecDerivLorentzian_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspectools.fitting.PySpecModel" title="pyspectools.fitting.PySpecModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspectools.fitting.PySpecModel</span></code></a></p>
<p>Child class of the PySpecModel, which in itself inherits from the <cite>lmfit</cite> <cite>Models</cite> class.
Gives the second derivative Lorentzian line shape profile for fitting.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.fitting.baseline_als">
<code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">baseline_als</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">lam</span><span class="o">=</span><span class="default_value">10000.0</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#baseline_als"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.baseline_als" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for performing an iterative baseline
fitting using the asymmetric least squares algorithm.</p>
<p>This refers to the paper:
“Baseline Correction with Asymmetric Least Squares Smoothing”
by Eilers and Boelens (2005).</p>
<p>The code is taken from a Stack Overflow question:
<a class="reference external" href="https://stackoverflow.com/a/29185844">https://stackoverflow.com/a/29185844</a></p>
<p>According to the paper, the tested values are:
0.001 &lt;= p &lt;= 0.1 for positive peaks
1e2 &lt;= lam &lt;= 1e9</p>
<dl class="simple">
<dt>y<span class="classifier">numpy 1D array</span></dt><dd><p>Data used to fit the baseline</p>
</dd>
<dt>lam<span class="classifier">float</span></dt><dd><p>Tuning factor for penalty function that offsets the difference cost function</p>
</dd>
<dt>p<span class="classifier">float</span></dt><dd><p>Weighting factor for the cost function</p>
</dd>
</dl>
<dl class="simple">
<dt>z<span class="classifier">numpy 1D array</span></dt><dd><p>Array containing the baseline values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.fitting.calc_harmonic_transition">
<code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">calc_harmonic_transition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">J</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">D</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#calc_harmonic_transition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.calc_harmonic_transition" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the transition frequency for
a given upper state J, B, and D.</p>
<p>J - quantum number
B - rotational constant in MHz
D - centrifugal distortion constant in MHz</p>
<p>transition frequency in MHz</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.fitting.harmonic_fitter">
<code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">harmonic_fitter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">progressions</span></em>, <em class="sig-param"><span class="n">J_thres</span><span class="o">=</span><span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#harmonic_fitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.harmonic_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will sequentially fit every progression
with a simple harmonic model defined by B and D. The
“B” value here actually corresponds to B+C for a near-prolate,
or 2B for a prolate top.</p>
<p>There are a number of filters applied in order to minimize
calculations that won’t be meaningful - these parameters
may have to be tuned for different test cases.</p>
<p>Because the model is not actually quantized, J is
represented as a float. To our advantage, this will
actually separate real (molecular) progressions from
fake news; at least half of the J values must be
close to being an integer for us to consider fitting.</p>
<p>progressions - iterable containing arrays of progressions
J_thres - optional argument corresponding to how close a</p>
<blockquote>
<div><p>value must be to an integer</p>
</div></blockquote>
<p>pandas dataframe containing the fit results; columns
are B, D, fit RMS, and pairs of columns corresponding
to the fitted frequency and approximate J value.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.fitting.quant_check">
<code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">quant_check</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#quant_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.quant_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will check if a value is close
to an integer to the absolute value of the threshold.</p>
<p>value - float for number to check
threshold - float determining whether value is</p>
<blockquote>
<div><p>close enough to being integer</p>
</div></blockquote>
<p>True if the value is close enough to being an integer,
False otherwise.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.fitting.rotor_energy">
<code class="sig-prename descclassname">pyspectools.fitting.</code><code class="sig-name descname">rotor_energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">J</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">D</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/fitting.html#rotor_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.fitting.rotor_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Expression for a linear/prolate top with
centrifugal distortion.</p>
<p>J - integer quantum number
B - rotational constant in MHz
D - CD term in MHz</p>
<p>state energy in MHz</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.ftmw_analysis">
<span id="cavity-ftmw-module"></span><h2>Cavity FTMW module<a class="headerlink" href="#module-pyspectools.ftmw_analysis" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyspectools.ftmw_analysis.AssayBatch">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">AssayBatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">exp_id</span></em>, <em class="sig-param"><span class="n">freq_col</span><span class="o">=</span><span class="default_value">'Frequency'</span></em>, <em class="sig-param"><span class="n">int_col</span><span class="o">=</span><span class="default_value">'Intensity'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.calc_scan_SNR">
<code class="sig-name descname">calc_scan_SNR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_int</span></em>, <em class="sig-param"><span class="n">noise_array</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.calc_scan_SNR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.calc_scan_SNR" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the signal-to-noise ratio of a peak
for a given reference noise intensity array
and peak intensity.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.dipole_analysis">
<code class="sig-name descname">dipole_analysis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_path</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">dipoles</span><span class="o">=</span><span class="default_value">[1.0, 0.01, 0.1, 1.0, 3.0, 5.0]</span></em>, <em class="sig-param"><span class="n">snr_thres</span><span class="o">=</span><span class="default_value">5.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.dipole_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.dipole_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for determining the optimal dipole moment to use
for each frequency in a given exported batch of dipole tests.</p>
<p>In addition to returning a pandas dataframe, it is also
stored as the object attribute dipole_df.</p>
<p>batch_path - filepath to the exported XY file from a QtFTM batch
thres - threshold in absolute intensity for peak detection (in Volts)
dipoles - list of dipole moments used in the screening
snr_thres - threshold in signal-to-noise for line detection</p>
<p>optimal_df - pandas dataframe containing the optimal dipole moments</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.find_progressions">
<code class="sig-name descname">find_progressions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.find_progressions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.find_progressions" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the dipole assay data to look for harmonic
progression.</p>
<p>Kwargs are passed into the affinity propagation
clustering; usually this means “preference” should
be set to tune the number of clusters.</p>
<dl class="simple">
<dt>cluster_dict - dictionary containing all of the clustered</dt><dd><p>progressions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.from_csv">
<em class="property">classmethod </em><code class="sig-name descname">from_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">exp_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.from_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an AssayBatch session by providing a
filepath to a file containing the frequency and
intensity information, as well as the experiment
ID from which it was based.</p>
<dl class="simple">
<dt>filepath - path to a CSV file with Frequency/Intensity</dt><dd><p>columns</p>
</dd>
</dl>
<p>exp_id - experiment ID; typically the chirp experiment number</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.generate_bruteforce_dr">
<code class="sig-name descname">generate_bruteforce_dr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">dr_channel</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.generate_bruteforce_dr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.generate_bruteforce_dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Brute force double resonance test on every single frequency
observed in the initial dipole test.</p>
<p>This method will perform DR measurements on sequentially
weaker lines, if the dipole_df is sorted by SNR.</p>
<p>Optionally, the</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.generate_magnet_test">
<code class="sig-name descname">generate_magnet_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.generate_magnet_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.generate_magnet_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an FT batch file for performing magnetic tests.</p>
<dl class="simple">
<dt>dataframe - dataframe used for the frequency information.</dt><dd><p>By default the dipole dataframe will be used.</p>
</dd>
<dt>cal - bool denoting whether a calibration line is used.</dt><dd><p>A user can provide it in kwargs, or use the default
which is the first line in the dataframe (strongest
if sorted by intensity)</p>
</dd>
<dt>nshots - optional int specifying number of shots for each</dt><dd><p>line, or if SNR is in the dataframe, the number
of shots for the strongest line.</p>
</dd>
<dt>kwargs - passed into the calibration settings, which are</dt><dd><p>cal_freq, cal_rate, and cal_shots</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.generate_progression_test">
<code class="sig-name descname">generate_progression_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">dr_channel</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.generate_progression_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.generate_progression_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the dipole moment dataframe and generate a DR batch.
If possible, we will instead use the progressions predicted
by the cluster model.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.load_session">
<em class="property">classmethod </em><code class="sig-name descname">load_session</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.load_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.load_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a previously saved AssayBatch session.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.plot_scan">
<code class="sig-name descname">plot_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scan_number</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.plot_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.plot_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick method for plotting up a strip to highlight a particular
scan in a batch.</p>
<p>scan_number - float corresponding to the scan</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.save_session">
<code class="sig-name descname">save_session</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.save_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.save_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to save the current assay analysis session to disk.</p>
<p>The data can be reloaded using the AssayBatch.load_session
class method.</p>
<dl class="simple">
<dt>filepath - path to save the data to. By default, the path will</dt><dd><p>be the experiment ID.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.AssayBatch.static_plot">
<code class="sig-name descname">static_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scan_number</span></em>, <em class="sig-param"><span class="n">dataframe</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#AssayBatch.static_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.AssayBatch.static_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a static plot with matplotlib of a particular
scan from a batch.</p>
<p>Saves the plot to ./assays/plots/</p>
<p>By default, the full dataframe will be used for the plotting.
Other dataframes (such as from other assays) can also be used.</p>
<p>scan_number - float corresponding to the scan of interest
dataframe - optional arg; pandas dataframe with Scan/Intensity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.ftmw_analysis.Batch">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">Batch</code><span class="sig-paren">(</span><em class="sig-param">assay: str</em>, <em class="sig-param">id: int</em>, <em class="sig-param">machine: str</em>, <em class="sig-param">date: datetime.datetime</em>, <em class="sig-param">scans: List = &lt;factory&gt;</em>, <em class="sig-param">filter: List = &lt;factory&gt;</em>, <em class="sig-param">exp: float = 0.0</em>, <em class="sig-param">zeropad: bool = False</em>, <em class="sig-param">window: str = ''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.assay">
<code class="sig-name descname">assay</code><em class="property">: str</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.assay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.create_dr_network">
<code class="sig-name descname">create_dr_network</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scans</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.create_dr_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.create_dr_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a list of scans, and generate a NetworkX Graph object
for analysis and plotting.
:param scans: list of scan IDs to connect
:return fig: Plotly FigureWidget object</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.date">
<code class="sig-name descname">date</code><em class="property">: datetime.datetime</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.exp">
<code class="sig-name descname">exp</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.filter">
<code class="sig-name descname">filter</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.find_optimum_scans">
<code class="sig-name descname">find_optimum_scans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.8</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.find_optimum_scans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.find_optimum_scans" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>thres</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.find_scan">
<code class="sig-name descname">find_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.find_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.find_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.from_pickle">
<em class="property">classmethod </em><code class="sig-name descname">from_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.from_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to create a Scan object from a previously pickled
Scan.
:param filepath: path to the Scan pickle
:return: instance of the Scan object</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.from_qtftm">
<em class="property">classmethod </em><code class="sig-name descname">from_qtftm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">assay</span></em>, <em class="sig-param"><span class="n">machine</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.from_qtftm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.from_qtftm" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Batch object from a QtFTM scan file.
:param filepath:
:param assay:
:param machine:
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.from_remote">
<em class="property">classmethod </em><code class="sig-name descname">from_remote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_path</span></em>, <em class="sig-param"><span class="n">batch_id</span></em>, <em class="sig-param"><span class="n">assay</span></em>, <em class="sig-param"><span class="n">machine</span></em>, <em class="sig-param"><span class="n">ssh_obj</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.from_remote"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.from_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Batch object by retrieving a QtFTM batch file from a remote
location. The user must provide a path to the root directory of the
batch type, e.g. /home/data/QtFTM/batch/, and the corresponding
batch type ID. Additionally, the type of batch must be specified to
determine the type of analysis required.</p>
<p>Optionally, the user can provide a reference to a RemoteClient object
from <cite>pyspectools.routines</cite>. If none is provided, a RemoteClient object
will be created with public key authentication (if available), otherwise
the user will be queried for a hostname, username, and password.</p>
<p>Keep in mind this method can be slow as every scan is downloaded. I
recommend creating this once, then saving a local copy for subsequent
analysis.
:param root_path: str path to the batch type root directory
:param batch_id: int or str value for the batch number
:param assay: str the batch type
:param machine: str reference the machine used for the batch
:param ssh_obj: <cite>RemoteClient</cite> object
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.get_scans">
<code class="sig-name descname">get_scans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_path</span></em>, <em class="sig-param"><span class="n">ids</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.get_scans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.get_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create Scan objects for all of the scans in
a QtFTM batch.
:param root_path: str scans root path
:param ids: list scan ids
:param src: str optional specifying whether a remote or local path is used</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.id">
<code class="sig-name descname">id</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.interactive_dr_batch">
<code class="sig-name descname">interactive_dr_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.interactive_dr_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.interactive_dr_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an interactive widget slider with a Plotly figure. The batch will be split
up into “subbatches” by the cavity frequency and whether or not the scan IDs are
consecutive.
:return vbox: VBox object with the Plotly figure and slider objects</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.machine">
<code class="sig-name descname">machine</code><em class="property">: str</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.machine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.plot_scans">
<code class="sig-name descname">plot_scans</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.plot_scans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.plot_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a plotly figure of all of the Scans within a Batch.
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.process_dr">
<code class="sig-name descname">process_dr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">significance</span><span class="o">=</span><span class="default_value">16.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.process_dr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.process_dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to batch process all of the DR measurements.
:param global_depletion: float between 0. and 1. specifying the expected depletion for any line</p>
<blockquote>
<div><p>without a specific expected value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>depletion_dict</strong> – dict with keys corresponding to cavity frequencies, and values the expected
depletion value between 0. and 1.</p>
</dd>
<dt class="field-even">Return dr_dict</dt>
<dd class="field-even"><p>dict with keys corresponding to cavity frequency, with each value
a dict of the DR frequencies, scan IDs and Scan objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.reprocess_fft">
<code class="sig-name descname">reprocess_fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.reprocess_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.reprocess_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Reprocess all of the FIDs with specified settings. The default values
are taken from the Batch attributes, and kwargs provided will override
the defaults.
:param kwargs:</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.scans">
<code class="sig-name descname">scans</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.scans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.search_frequency">
<code class="sig-name descname">search_frequency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.search_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.search_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Search the Batch scans for a particular frequency, and return
any scans that lie within the tolerance window
:param frequency: float specifying frequency to search
:param tol: float decimal percentage to use for the search tolerance
:return new_batch: a new Batch object with selected scans</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.split_progression_batch">
<code class="sig-name descname">split_progression_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.split_progression_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.split_progression_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Split up a DR batch into individual progressions based on the cavity frequency
and whether or not the scan IDs are consecutive.
:return progressions: dict with keys corresponding to progression index and values are lists of Scans</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Batch.to_pickle">
<code class="sig-name descname">to_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Batch.to_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickles the Batch object with the joblib wrapper implemented
in routines.
:param filepath: optional argument to pickle to. Defaults to the {assay}-{id}.pkl
:param kwargs: additional settings for the pickle operation</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.window">
<code class="sig-name descname">window</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.window" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Batch.zeropad">
<code class="sig-name descname">zeropad</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Batch.zeropad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">BlackChirpFid</code><span class="sig-paren">(</span><em class="sig-param">xy_data: &lt;built-in function array&gt;</em>, <em class="sig-param">header: Dict = &lt;factory&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackChirpFid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.determine_frequencies">
<code class="sig-name descname">determine_frequencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackChirpFid.determine_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.determine_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the frequency bins for the FFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Array containing the frequency bins (x values)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>frequency - numpy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.from_binary">
<em class="property">classmethod </em><code class="sig-name descname">from_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackChirpFid.from_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.from_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a BlackChirp FID object from a binary BlackChirp FID file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- str</strong> (<em>filepath</em>) – Filepath to the BlackChirp .fid file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>BlackChirpFid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.header">
<code class="sig-name descname">header</code><em class="property">: Dict</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.perform_fft">
<code class="sig-name descname">perform_fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'boxcar'</span></em>, <em class="sig-param"><span class="n">f_min</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">f_max</span><span class="o">=</span><span class="default_value">30000.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackChirpFid.perform_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.perform_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an FFT on the current FID to get the frequency domain spectrum.
All of the arguments are optional, and provide control over how the FFT is performed, as well as post-processing
parameters like window functions and zero-padding.</p>
<p>This is based on the FFT code by Kyle Crabtree, with modifications to fit this dataclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> (<em>zpf</em>) – Starting index for the FID array to perform the FFT</p></li>
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> – End index for the FID array to perform the FFT</p></li>
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> – Pad the FID with zeros to nth nearest power of 2</p></li>
<li><p><strong>- str</strong> (<em>window</em>) – Specify the window function used to process the FID. Defaults to boxcar, which is effectively no filtering.
The names of the window functions available can be found at:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html">https://docs.scipy.org/doc/scipy/reference/signal.windows.html</a></p></li>
<li><p><strong>- float</strong> (<em>f_max</em>) – Specify the minimum frequency in the spectrum; everything below this value is set to zero</p></li>
<li><p><strong>- float</strong> – Specify the maximum frequency in the spectrum; everything above this value is set to zero</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.to_pickle">
<code class="sig-name descname">to_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackChirpFid.to_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the Blackchirp FID to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- str</strong> (<em>filepath</em>) – Filepath to save the FID to</p></li>
<li><p><strong>- dict-like</strong> (<em>kwargs</em>) – Additional keyword arguments that are passed to the
pickle function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackChirpFid.xy_data">
<code class="sig-name descname">xy_data</code><em class="property">: np.array</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackChirpFid.xy_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">BlackchirpExperiment</code><span class="sig-paren">(</span><em class="sig-param">exp_id: int</em>, <em class="sig-param">fid_start: int = 0</em>, <em class="sig-param">fid_end: int = -1</em>, <em class="sig-param">ft_min: float = 0.0</em>, <em class="sig-param">ft_max: float = 40000.0</em>, <em class="sig-param">ft_filter: str = 'boxcar'</em>, <em class="sig-param">freq_offset: float = 0.0</em>, <em class="sig-param">fids: List = &lt;factory&gt;</em>, <em class="sig-param">header: Dict = &lt;factory&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackchirpExperiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.exp_id">
<code class="sig-name descname">exp_id</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.exp_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.fid_end">
<code class="sig-name descname">fid_end</code><em class="property">: int</em><em class="property"> = -1</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.fid_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.fid_start">
<code class="sig-name descname">fid_start</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.fid_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.fids">
<code class="sig-name descname">fids</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.fids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.freq_offset">
<code class="sig-name descname">freq_offset</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.freq_offset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.from_dir">
<em class="property">classmethod </em><code class="sig-name descname">from_dir</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackchirpExperiment.from_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.from_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.ft_filter">
<code class="sig-name descname">ft_filter</code><em class="property">: str</em><em class="property"> = 'boxcar'</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.ft_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.ft_max">
<code class="sig-name descname">ft_max</code><em class="property">: float</em><em class="property"> = 40000.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.ft_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.ft_min">
<code class="sig-name descname">ft_min</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.ft_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.header">
<code class="sig-name descname">header</code><em class="property">: Dict</em><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.BlackchirpExperiment.process_ffts">
<code class="sig-name descname">process_ffts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weighting</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#BlackchirpExperiment.process_ffts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.BlackchirpExperiment.process_ffts" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch perform FFTs on all of the FIDs. The end result is a Pandas DataFrame with the Frequency and Intensity
data, where the intensity is just the weighted co-average of all the FFTs. By default, every FID is equally
weighted.
:param weighting:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.ftmw_analysis.Scan">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">Scan</code><span class="sig-paren">(</span><em class="sig-param">id: int</em>, <em class="sig-param">machine: str</em>, <em class="sig-param">fid: numpy.array</em>, <em class="sig-param">date: datetime.datetime</em>, <em class="sig-param">shots: int = 0</em>, <em class="sig-param">cavity_voltage: int = 0</em>, <em class="sig-param">cavity_atten: int = 0</em>, <em class="sig-param">cavity_frequency: float = 0.0</em>, <em class="sig-param">dr_frequency: float = 0.0</em>, <em class="sig-param">dr_power: int = 0</em>, <em class="sig-param">fid_points: int = 0</em>, <em class="sig-param">fid_spacing: float = 0.0</em>, <em class="sig-param">discharge: bool = False</em>, <em class="sig-param">magnet: bool = False</em>, <em class="sig-param">gases: Dict = &lt;factory&gt;</em>, <em class="sig-param">filter: List = &lt;factory&gt;</em>, <em class="sig-param">exp: float = 0.0</em>, <em class="sig-param">zeropad: bool = False</em>, <em class="sig-param">window: str = ''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DataClass for a Scan. Holds all of the relevant information that
describes a FT scan, such as the ID, what machine it was collected
on, and the experimental settings.</p>
<p>Has a few class methods that will make look ups easily such as
the date the scan was collected and the gases used.</p>
<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.add_frequency">
<code class="sig-name descname">add_frequency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.add_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.add_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to add another Scan from the current in the frequency domain.
:param other: Scan object to add with
:return: A new Scan object with the co-added spectrum</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.average">
<code class="sig-name descname">average</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">others</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Dunder method to co-average two or more Scans in the time domain.
:param other: Scan object, or tuple/list
:return: A new Scan object with the co-added FID</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.calc_snr">
<code class="sig-name descname">calc_snr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">noise</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.calc_snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.calc_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.cavity_atten">
<code class="sig-name descname">cavity_atten</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.cavity_atten" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.cavity_frequency">
<code class="sig-name descname">cavity_frequency</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.cavity_frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.cavity_voltage">
<code class="sig-name descname">cavity_voltage</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.cavity_voltage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.date">
<code class="sig-name descname">date</code><em class="property">: datetime.datetime</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.discharge">
<code class="sig-name descname">discharge</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.discharge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.dr_frequency">
<code class="sig-name descname">dr_frequency</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.dr_frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.dr_power">
<code class="sig-name descname">dr_power</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.dr_power" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.exp">
<code class="sig-name descname">exp</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.fid">
<code class="sig-name descname">fid</code><em class="property">: np.array</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.fid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.fid_points">
<code class="sig-name descname">fid_points</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.fid_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.fid_spacing">
<code class="sig-name descname">fid_spacing</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.fid_spacing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.filter">
<code class="sig-name descname">filter</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.fit_cavity">
<code class="sig-name descname">fit_cavity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.fit_cavity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.fit_cavity" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a fit to the cavity spectrum. Uses a paired Gaussian model
that minimizes the number of fitting parameters.
:param plot: bool specify whether a Plotly figure is made
:return: Model Fit result</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to initialize a Scan object from a dictionary
of FT scan data collected from <cite>parse_scan</cite>.
:param data_dict: dict containing parsed data from FT
:return: Scan object</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.from_pickle">
<em class="property">classmethod </em><code class="sig-name descname">from_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.from_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to create a Scan object from a previously pickled
Scan.
:param filepath: path to the Scan pickle
:return: instance of the Scan object</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.from_qtftm">
<em class="property">classmethod </em><code class="sig-name descname">from_qtftm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.from_qtftm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.from_qtftm" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to initialize a Scan object from a FT scan file.
Will load the lines into memory and parse the data into
a dictionary, which then gets passed into a Scan object.
:param filepath: str path to FID file
:return: Scan object</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.from_remote">
<em class="property">classmethod </em><code class="sig-name descname">from_remote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">remote_path</span></em>, <em class="sig-param"><span class="n">ssh_obj</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.from_remote"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.from_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to initialize a Scan object from a remote server.
Has the option to pass an instance of a paramiko SSHClient, which would be
useful in a Batch. If none is supplied, an instance will be created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remote_path</strong> – str remote path to the file</p></li>
<li><p><strong>ssh_obj</strong> – optional argument to supply a paramiko SSHClient object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scan object from remote QtFTM file</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.gases">
<code class="sig-name descname">gases</code><em class="property">: Dict</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.gases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.get_line_roi">
<code class="sig-name descname">get_line_roi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.get_line_roi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.get_line_roi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.id">
<code class="sig-name descname">id</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.is_depleted">
<code class="sig-name descname">is_depleted</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ref</span></em>, <em class="sig-param"><span class="n">roi</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">depletion</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.is_depleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.is_depleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for determining if the signal in this Scan is less
than that of another scan. This is done by a simple comparison
of the average of 10 largest intensities in the two spectra. If
the current scan is less intense than the reference by the
expected depletion percentage, then it is “depleted”.</p>
<p>This function can be used to determine if a scan if depleted
in DR/magnet/discharge assays.</p>
<dl class="simple">
<dt>TODO - implement a chi squared test of sorts to determine if a</dt><dd><p>depletion is statistically significant</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> – second Scan object for comparison</p></li>
<li><p><strong>depletion</strong> – percentage of depletion expected of the reference</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool - True if signal in this Scan is less intense than the reference</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.machine">
<code class="sig-name descname">machine</code><em class="property">: str</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.machine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.magnet">
<code class="sig-name descname">magnet</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.magnet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.process_fid">
<code class="sig-name descname">process_fid</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.process_fid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.process_fid" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an FFT on the FID to yield the frequency domain spectrum.
Kwargs are passed into the FID processing, which will override the
Scan attributes.
:param kwargs: Optional keyword arguments for processing the FID</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.scatter_trace">
<code class="sig-name descname">scatter_trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.scatter_trace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.scatter_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Plotly Scattergl trace. Called by the Batch function, although
performance-wise it takes forever to plot up ~3000 scans.
:return trace: Scattergl object</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.shots">
<code class="sig-name descname">shots</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.shots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.subtract_frequency">
<code class="sig-name descname">subtract_frequency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.subtract_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.subtract_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to subtract another Scan from the current in the frequency domain.
:param other: Scan object to subtract with
:return: A new Scan object with the subtracted spectrum</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.to_file">
<code class="sig-name descname">to_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">'yaml'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to dump data to YAML format.
Extensions are automatically decided, but
can also be supplied.</p>
<p>:param filepath - str path to yaml file
:param format - str denoting the syntax used for dumping. Defaults to YAML.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.to_pickle">
<code class="sig-name descname">to_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.to_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickles the Scan object with the joblib wrapper implemented
in routines.
:param filepath: optional argument to pickle to. Defaults to the id.pkl
:param kwargs: additional settings for the pickle operation</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.window">
<code class="sig-name descname">window</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.window" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.ftmw_analysis.Scan.within_time">
<code class="sig-name descname">within_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date_range</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#Scan.within_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.within_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for determining of the scan was taken between
a specified date range in month/day/year, in the format
04/09/08 for April 9th, 2008.
:param date_range: list containing the beginning and end date strings
:return: bool - True if within range, False otherwise</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.ftmw_analysis.Scan.zeropad">
<code class="sig-name descname">zeropad</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.ftmw_analysis.Scan.zeropad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.apply_butter_filter">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">apply_butter_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">low</span></em>, <em class="sig-param"><span class="n">high</span></em>, <em class="sig-param"><span class="n">rate</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#apply_butter_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.apply_butter_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>A modified Butterworth bandpass filter, adapted from the Scipy cookbook.</p>
<p>The argument data supplies the FID, which then uses the scipy signal
processing function to apply the digital filter, and returns the filtered
FID.</p>
<p>See the <cite>butter_bandpass</cite> function for additional arguments.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.butter_bandpass">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">butter_bandpass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">low</span></em>, <em class="sig-param"><span class="n">high</span></em>, <em class="sig-param"><span class="n">rate</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#butter_bandpass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.butter_bandpass" title="Permalink to this definition">¶</a></dt>
<dd><p>A modified version of the Butterworth bandpass filter described here,
adapted for use with the FID signal.
<a class="reference external" href="http://scipy-cookbook.readthedocs.io/items/ButterworthBandpass.html">http://scipy-cookbook.readthedocs.io/items/ButterworthBandpass.html</a>
The arguments are:</p>
<p>:param low The low frequency cut-off, given in kHz.
:param high The high frequency cut-off, given in kHz.
:param rate The sampling rate, given in Hz. From the FIDs, this means that</p>
<blockquote>
<div><p>the inverse of the FID spacing is used.</p>
</div></blockquote>
<p>:return bandpass window</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.calculate_integration_times">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">calculate_integration_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensity</span></em>, <em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#calculate_integration_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.calculate_integration_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for calculating the expected integration time
in shot counts based on the intensity; either theoretical
line strengths or SNR.</p>
<p>intensity - array of intensity metric; e.g. SNR
nshots - optional int number of shots used for the strongest line</p>
<p>shot_counts - array of shot counts for each frequency</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.categorize_frequencies">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">categorize_frequencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">intensities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">power</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attn_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dipole</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attn</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magnet</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">discharge</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#categorize_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.categorize_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will format an FT batch file to perform categorization
tests, with some flexibility on how certain tests are performed.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.center_cavity">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">center_cavity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#center_cavity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.center_cavity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the center frequency of a Doppler pair in cavity FTM measurements
and provides a column of offset frequencies.</p>
<p>Sometimes the peak finding threshold has to be tweaked to get the center
frequency correctly.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.fid2fft">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">fid2fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fid</span></em>, <em class="sig-param"><span class="n">rate</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#fid2fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.fid2fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Process an FID by performing an FFT to yield the frequency domain
information. Kwargs are passed as additional processing options,
and are implemented as some case statements to ensure the settings
are valid (e.g. conforms to sampling rate, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fid</strong> – np.array corresponding to the FID intensity</p></li>
<li><p><strong>rate</strong> – sampling rate in Hz</p></li>
<li><p><strong>frequencies</strong> – np.array corresponding to the frequency bins</p></li>
<li><p><strong>kwargs</strong> – <p>signal processing options:
delay - delays the FID processing by setting the start</p>
<blockquote>
<div><p>of the FID to zero</p>
</div></blockquote>
<dl class="simple">
<dt>zeropad - Toggles whether or not the number of sampled</dt><dd><p>points is doubled to get artificially higher
resolution in the FFT</p>
</dd>
</dl>
<p>window - Various window functions provided by <cite>scipy.signal</cite>
exp - Specifies an exponential filter
filter - 2-tuple specifying the frequency cutoffs for a</p>
<blockquote>
<div><p>band pass filter</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>freq_df - pandas dataframe with the FFT spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.generate_ftb_line">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">generate_ftb_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">shots</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#generate_ftb_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.generate_ftb_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that generates an FTB file for a list of
frequencies, plus categorization tests.</p>
<p>kwargs are passed as additional options for the ftb
batch. Keywords are:</p>
<p>magnet: bool
dipole: float
atten: int
skiptune: bool
drfreq: float
drpower: int
cal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> – float for frequency in MHz</p></li>
<li><p><strong>shots</strong> – int number of shots to integrate for</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return ftbline</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.neu_categorize_frequencies">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">neu_categorize_frequencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">intensities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nshots</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#neu_categorize_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.neu_categorize_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to generate an FTB batch file for performing a series of tests
on frequencies.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.parse_batch">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">parse_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filecontents</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#parse_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.parse_batch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.parse_scan">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">parse_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filecontents</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#parse_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.parse_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for extracting the FID data from an FT scan. The data
is returned as a dictionary, which can be used to initialize a
Scan object.
:param filecontents: list of lines from an FID file
:return: dict containing parsed data from FID</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.parse_specdata">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">parse_specdata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#parse_specdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.parse_specdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.parse_spectrum">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">parse_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">20.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#parse_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.parse_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a blackchirp or QtFTM spectrum from file</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.perform_fft">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">perform_fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fid</span></em>, <em class="sig-param"><span class="n">spacing</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'boxcar'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#perform_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.perform_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an FFT on an FID to get the frequency domain spectrum.
All of the arguments are optional, and provide control over how the FFT is performed, as well as post-processing
parameters like window functions and zero-padding.</p>
<p>This is based on the FFT code by Kyle Crabtree, with modifications to fit this dataclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- Numpy 1D array</strong> (<em>fid</em>) – Array holding the values of the FID</p></li>
<li><p><strong>- float</strong> (<em>spacing</em>) – Time spacing between FID points in microseconds</p></li>
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> (<em>zpf</em>) – Starting index for the FID array to perform the FFT</p></li>
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> – End index for the FID array to perform the FFT</p></li>
<li><p><strong>- int</strong><strong>, </strong><strong>optional</strong> – Pad the FID with zeros to nth nearest power of 2</p></li>
<li><p><strong>- str</strong> (<em>window</em>) – Specify the window function used to process the FID. Defaults to boxcar, which is effectively no filtering.
The names of the window functions available can be found at:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html">https://docs.scipy.org/doc/scipy/reference/signal.windows.html</a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.ftmw_analysis.predict_prolate_series">
<code class="sig-prename descclassname">pyspectools.ftmw_analysis.</code><code class="sig-name descname">predict_prolate_series</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">progressions</span></em>, <em class="sig-param"><span class="n">J_thres</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/ftmw_analysis.html#predict_prolate_series"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.ftmw_analysis.predict_prolate_series" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="spectroscopic-lineshapes-module">
<h2>Spectroscopic lineshapes module<a class="headerlink" href="#spectroscopic-lineshapes-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-pyspectools.lineshapes"></span><dl class="py function">
<dt id="pyspectools.lineshapes.fast_multi_gaussian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">fast_multi_gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">A</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x0</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#fast_multi_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.fast_multi_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast, parallel implementation of a mixture of Gaussian lineshapes.
Uses the <cite>gaussian</cite> function defined in this module, which itself is
also JIT’d, and uses parallel loops to evaluate multiple Gaussians.</p>
<p>The result is a NumPy 2D array of shape N x D, where N is the length
of the frequency array, and D is the number of Gaussians.</p>
<p>The inputs are expected to all be NumPy arrays, where A, x0, and w
all equal in length and contain parameters for each respective Gaussian.</p>
<p>With a 200,000 length frequency array and about 70 Gaussians, this code
takes ~70 ms to compute; about four times faster than the unJIT’d version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – [description]</p></li>
<li><p><strong>A</strong> (<em>np.ndarray</em>) – [description]</p></li>
<li><p><strong>x0</strong> (<em>np.ndarray</em>) – [description]</p></li>
<li><p><strong>w</strong> (<em>np.ndarray</em>) – [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.lineshapes.first_deriv_lorentzian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">first_deriv_lorentzian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">gamma</span></em>, <em class="sig-param"><span class="n">I</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#first_deriv_lorentzian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.first_deriv_lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to evaluate the first derivative of a Lorentzian lineshape function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Numpy 1D array</em>) – Array of floats corresponding to the x values to evaluate on</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Center for the distribution</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Width of the distribution</p></li>
<li><p><strong>I</strong> (<em>float</em>) – Height of the distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Values of the Lorentzian distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.lineshapes.gaussian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">A</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Vectorized implementation of a single Gaussian lineshape. For a given
array of <cite>x</cite> values, we compute the corresponding amplitude of a
Gaussian for a set of amplitude, center, and widths.</p>
<p>Uses JIT compilation with Numba, and should be reasonably fast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – NumPy 1D array containing x values to evaluate over.</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Scaling of the Gaussian; actually corresponds to the area.</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Center of the Gaussian</p></li>
<li><p><strong>w</strong> (<em>float</em>) – Width of the Gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of amplitude values of the specified Gaussian</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>NumPy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.lineshapes.lorentzian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">lorentzian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">gamma</span></em>, <em class="sig-param"><span class="n">I</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#lorentzian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to evaluate a Lorentzian lineshape function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Numpy 1D array</em>) – Array of floats corresponding to the x values to evaluate on</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Center for the distribution</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Width of the distribution</p></li>
<li><p><strong>I</strong> (<em>float</em>) – Height of the distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Values of the Lorentzian distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.lineshapes.pair_gaussian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">pair_gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">A1</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">A2</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">x0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">xsep</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#pair_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.pair_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Paired Gaussian lineshape. The function allows for the amplitudes to be
floated, however the two Gaussians are locked in width and center
frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – [description]</p></li>
<li><p><strong>A2</strong> (<em>A1</em><em>,</em>) – Amplitude of the two Gaussians</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Centroid of the two Gaussians</p></li>
<li><p><strong>w</strong> (<em>float</em>) – Width of the two Gaussians</p></li>
<li><p><strong>xsep</strong> (<em>float</em>) – Distance from the centroid and a Gaussian center</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of amplitude values of the pair of Gaussians</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>NumPy 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.lineshapes.sec_deriv_lorentzian">
<code class="sig-prename descclassname">pyspectools.lineshapes.</code><code class="sig-name descname">sec_deriv_lorentzian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">gamma</span></em>, <em class="sig-param"><span class="n">I</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/lineshapes.html#sec_deriv_lorentzian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.lineshapes.sec_deriv_lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to evaluate the second derivative of a Lorentzian lineshape function.
This was evaluated analytically with SymPy by differentiation of the
Lorentzian expression used for the <cite>lorentzian</cite> function in this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Numpy 1D array</em>) – Array of floats corresponding to the x values to evaluate on</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Center for the distribution</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Width of the distribution</p></li>
<li><p><strong>I</strong> (<em>float</em>) – Height of the distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Values of the Lorentzian distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy 1D array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.parsers">
<span id="standard-parsers-module"></span><h2>Standard parsers module<a class="headerlink" href="#module-pyspectools.parsers" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyspectools.parsers.parse_ascii">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">delimiter</span><span class="o">=</span><span class="default_value">'\t'</span></em>, <em class="sig-param"><span class="n">names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skiprows</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_ascii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_ascii" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic ASCII parser wrapping the pandas read_csv function.
:param filename:
:param delimiter:
:param names:
:param header:
:param skiprows:</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.parse_blackchirp">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_blackchirp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dir_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_blackchirp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_blackchirp" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for reading in a Blackchirp experiment. The required input should point to the directory
containing the Blackchirp files with the correct extensions: .hdr, .tdt, and .fid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- str</strong> (<em>dir_path</em>) – Filepath pointing to the directory containing the Blackchirp experiment files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.parse_cat">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simulation_path</span></em>, <em class="sig-param"><span class="n">low_freq</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">high_freq</span><span class="o">=</span><span class="default_value">inf</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">- inf</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a simulation output, and filters the frequency and intensity to give
a specific set of lines.</p>
<p>The only argument that is required is the path to the simulation output. Others
are optional, and will default to effectively not filter.</p>
<p>The quantum numbers are read in assuming hyperfine structure, and thus
might not be accurate descriptions of what they actually are.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.parse_fit">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to parse the output of an SPFIT .fit file. This version of the code is barebones compared to the
previous iteration, which provides more feedback. This version simply returns a dictionary containing the
obs - calc for each line, the fitted parameters, and the microwave RMS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – Filepath to the .fit file to parse.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fit_dict</strong> – Dictionary containing the parsed data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.parse_lin">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_lin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a line file, formatted in the SPFIT
convention.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.parse_spectrum">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">parse_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">20.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#parse_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.parse_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a blackchirp or QtFTM spectrum from file</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.parsers.read_binary_fid">
<code class="sig-prename descclassname">pyspectools.parsers.</code><code class="sig-name descname">read_binary_fid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/parsers.html#read_binary_fid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.parsers.read_binary_fid" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a binary Blackchirp FID file. This is based on the original code by Kyle Crabtree, with some minor
perfomance improvements by Kelvin Lee. The only difference is most of the for loops for reading the points
have been replaced by numpy broadcasts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>- str</strong> (<em>filepath</em>) – Filepath to the Blackchirp .fid file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>param_dict - dict</em> – Contains header information about the FID, such as the number of shots, point spacing, etc.</p></li>
<li><p><em>xy_data - 2-tuple of numpy 1D array</em> – Contains two columns; xy_data[0] is the time data in microseconds, and xy_data[1] is the
signal.</p></li>
<li><p><em>raw_data - numpy 1D array</em> – Contains the raw, uncorrected ADC sums. The signal data is converted from this by scaling
it with the multiplication factor v_mult.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.pypickett">
<span id="pypickett-module"></span><h2>PyPickett module<a class="headerlink" href="#module-pyspectools.pypickett" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyspectools.pypickett.AutoFitSession">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.pypickett.</code><code class="sig-name descname">AutoFitSession</code><span class="sig-paren">(</span><em class="sig-param">filename: str</em>, <em class="sig-param">n_numbers: int</em>, <em class="sig-param">frequencies: List = &lt;factory&gt;</em>, <em class="sig-param">uncertainties: List = &lt;factory&gt;</em>, <em class="sig-param">centers: List = &lt;factory&gt;</em>, <em class="sig-param">widths: List = &lt;factory&gt;</em>, <em class="sig-param">deltas: List = &lt;factory&gt;</em>, <em class="sig-param">j: List = &lt;factory&gt;</em>, <em class="sig-param">method: str = 'mc'</em>, <em class="sig-param">rms_target: float = 1.0</em>, <em class="sig-param">rms: float = 1000000000.0</em>, <em class="sig-param">nfit: int = 0</em>, <em class="sig-param">niter: int = 10000</em>, <em class="sig-param">nprocesses: int = 1</em>, <em class="sig-param">verbose: int = 0</em>, <em class="sig-param">debug: bool = False</em>, <em class="sig-param">clean: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.centers">
<code class="sig-name descname">centers</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.centers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.clean">
<code class="sig-name descname">clean</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.clean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.debug">
<code class="sig-name descname">debug</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.deltas">
<code class="sig-name descname">deltas</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.deltas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.filename">
<code class="sig-name descname">filename</code><em class="property">: str</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.AutoFitSession.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nlines</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in all of the YAML parsed fits, and reduces the number of possible fits
a person has to look through.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nlines</strong> (<em>int</em>) – Integer value for the minimum number of lines seen in the observed - calc. parse</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>viable</strong> – Dictionary with indexes corresponding to the fit number, and values are the parsed
fit dictionaries</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.frequencies">
<code class="sig-name descname">frequencies</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.frequencies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.AutoFitSession.from_pkl">
<em class="property">classmethod </em><code class="sig-name descname">from_pkl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession.from_pkl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.from_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load a previously saved Pickle instance of AutoFitSession.</p>
<p>TODO: write a check to make sure we’re reading in an AutoFitSession pickle!
:param filepath: Filepath to the pickle file to load.
:type filepath: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.AutoFitSession.from_yml">
<em class="property">classmethod </em><code class="sig-name descname">from_yml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession.from_yml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.from_yml" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method to read the settings for an AutoFitSession via YAML file.
:param filepath: Filepath to the YAML settings file
:type filepath: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>AutoFitSession object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.j">
<code class="sig-name descname">j</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.j" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.method">
<code class="sig-name descname">method</code><em class="property">: str</em><em class="property"> = 'mc'</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.method" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.n_numbers">
<code class="sig-name descname">n_numbers</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.n_numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.nfit">
<code class="sig-name descname">nfit</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.nfit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.niter">
<code class="sig-name descname">niter</code><em class="property">: int</em><em class="property"> = 10000</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.niter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.nprocesses">
<code class="sig-name descname">nprocesses</code><em class="property">: int</em><em class="property"> = 1</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.nprocesses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.rms">
<code class="sig-name descname">rms</code><em class="property">: float</em><em class="property"> = 1000000000.0</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.rms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.rms_target">
<code class="sig-name descname">rms_target</code><em class="property">: float</em><em class="property"> = 1.0</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.rms_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.AutoFitSession.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nprocesses</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">headless</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'mc'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the search for assignments. The function wraps a private method, and is parallelized with a joblib
Pool.
:param niter: Number of iterations. If None, uses the class attribute, otherwise the user specified value.
:type niter: int or None, optional
:param nprocesses: Number of parallel jobs to break the task into. If None, uses the class attribute.
:type nprocesses: int or None, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>results</strong> – List of the final RMS values from individual SPFIT runs.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.AutoFitSession.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#AutoFitSession.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the current session to disk as a Pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em><em>, </em><em>optional</em>) – Filepath to save the file to. If None, uses the filename attribute plus .pkl extension</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.uncertainties">
<code class="sig-name descname">uncertainties</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.uncertainties" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.verbose">
<code class="sig-name descname">verbose</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.verbose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.AutoFitSession.widths">
<code class="sig-name descname">widths</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.AutoFitSession.widths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.GenerateCatalog">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.pypickett.</code><code class="sig-name descname">GenerateCatalog</code><span class="sig-paren">(</span><em class="sig-param">niter: int = 10</em>, <em class="sig-param">temp_path: str = ''</em>, <em class="sig-param">out_path: str = ''</em>, <em class="sig-param">temp_dict: Dict = &lt;factory&gt;</em>, <em class="sig-param">constants_dict: Dict = &lt;factory&gt;</em>, <em class="sig-param">constants: List = &lt;factory&gt;</em>, <em class="sig-param">cwd: str = ''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#GenerateCatalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.constants">
<code class="sig-name descname">constants</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.constants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.constants_dict">
<code class="sig-name descname">constants_dict</code><em class="property">: Dict</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.constants_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.cwd">
<code class="sig-name descname">cwd</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.cwd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.GenerateCatalog.generate_constants">
<code class="sig-name descname">generate_constants</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lower</span><span class="o">=</span><span class="default_value">1000.0</span></em>, <em class="sig-param"><span class="n">upper</span><span class="o">=</span><span class="default_value">10000.0</span></em>, <em class="sig-param"><span class="n">distortion</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#GenerateCatalog.generate_constants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.generate_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate a random set of constants for an Asymmetric top
based on a uniform random distribution. This also includes centrifugal
distortion terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upper</strong> (<em>lower</em><em>,</em>) – Lower and upper bounds for constants to be generated, in MHz.</p></li>
<li><p><strong>distortion</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, quartic centrifugal distortion terms are also included
in the simulation. This option is on by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>constants_dict</strong> – Dictionary with generated rotational constants</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.niter">
<code class="sig-name descname">niter</code><em class="property">: int</em><em class="property"> = 10</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.niter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.out_path">
<code class="sig-name descname">out_path</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.out_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.GenerateCatalog.run_batch">
<code class="sig-name descname">run_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">progressbar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#GenerateCatalog.run_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.run_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a batch of simulations. This is the main function to be called by a
user, and will automatically carry out all of the book keeping and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>niter</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Number of simulations to perform. This option overrides the class
attribute, and if the user provided argument is None, will just use
that instead.</p></li>
<li><p><strong>progressbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, wraps the iterator with a <cite>tqdm</cite> progress bar.</p></li>
<li><p><strong>kwargs</strong> – Additional kwargs are passed into the <cite>generate_constants</cite>
function, which allows for control on bounds, etc.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.GenerateCatalog.run_spcat">
<code class="sig-name descname">run_spcat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#GenerateCatalog.run_spcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.run_spcat" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run SPCAT from within Python. The function does so with
temporary folders within a context manager, such that there are no
scratch files left behind when the process is finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>catalog</strong> – PySpecTools LineList object based on the digested catalog</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>LineList object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.temp_dict">
<code class="sig-name descname">temp_dict</code><em class="property">: Dict</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.temp_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.GenerateCatalog.temp_path">
<code class="sig-name descname">temp_path</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#pyspectools.pypickett.GenerateCatalog.temp_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.MoleculeFit">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.pypickett.</code><code class="sig-name descname">MoleculeFit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for handling the top level of a Pickett simulation.
Inspired by PGopher, the <cite>molecule</cite> class stores information about
whether we’re dealing with a diatomic or polyatomic, number of lines
to fit, temperature, etc.</p>
<p>All of the information is bundled into a dictionary called <cite>properties</cite>.</p>
<p>There are two methods right now that will generate a <cite>molecule</cite> object;
<cite>from_json</cite> and <cite>from_yaml</cite>, which will interpret JSON and YAML input
files respectively.</p>
<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.backup">
<code class="sig-name descname">backup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">comment</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.backup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.backup" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for backing up files for a specific reason.
The most common use I have for this is to backup .cat and .lin files
for whatever reason (adding/removing lines to/from fit)</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.calbak">
<code class="sig-name descname">calbak</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.calbak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.calbak" title="Permalink to this definition">¶</a></dt>
<dd><p>Run calbak to generate a .lin file from .cat</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.check_input">
<code class="sig-name descname">check_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.check_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.check_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for going through the input settings and flagging common
mistakes.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.copy_settings">
<code class="sig-name descname">copy_settings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iteration</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.copy_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.copy_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy settings used in a previous iteration
If none specified, we’ll take the settings from before the first fit</p>
</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.MoleculeFit.exp_line">
<em class="property">class </em><code class="sig-name descname">exp_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">uncertainty</span></em>, <em class="sig-param"><span class="n">lower_num</span></em>, <em class="sig-param"><span class="n">upper_num</span></em>, <em class="sig-param"><span class="n">comment</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.exp_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.exp_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for an experimental line. Converts to and from .lin files.</p>
<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.exp_line.format_line">
<code class="sig-name descname">format_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.exp_line.format_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.exp_line.format_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.exp_line.format_quantum_numbers">
<code class="sig-name descname">format_quantum_numbers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.exp_line.format_quantum_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.exp_line.format_quantum_numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.exp_line.update_line">
<code class="sig-name descname">update_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.exp_line.update_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.exp_line.update_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.finalize">
<code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iteration</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Been hard to keep track which iteration was the final one
sometimes, and so this function will “finalize” the fits by
creating a separate folder for the final fits.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.fit_lines">
<code class="sig-name descname">fit_lines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.fit_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.fit_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.from_json">
<em class="property">classmethod </em><code class="sig-name descname">from_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">json_filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.from_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.from_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.from_pickle">
<em class="property">classmethod </em><code class="sig-name descname">from_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">picklepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.from_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.generate_parameter_objects">
<code class="sig-name descname">generate_parameter_objects</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.generate_parameter_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.generate_parameter_objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that will rewrite the .par and .int files, after updating
the properties dictionary.</p>
<p>Any warnings regarding common mistakes in input files should also be
flagged here.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.nuclear">
<code class="sig-name descname">nuclear</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delete</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.nuclear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.nuclear" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that cleans up Pickett files in a folder</p>
</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.MoleculeFit.parameter">
<em class="property">class </em><code class="sig-name descname">parameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">reduction</span><span class="o">=</span><span class="default_value">'A'</span></em>, <em class="sig-param"><span class="n">linear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for handling parameters in Pickett.
Each instance has a human name (i.e. A, B, C constants) which
is to be translated to Pickett identifiers.</p>
<p>A <cite>fit</cite> flag is used to denote whether or not the parameter
is going to be fit, which automatically sets the uncertainty
to a large number.</p>
<p>Nuclear spin terms will have the nuclei identifier</p>
<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.parameter.fit_check">
<code class="sig-name descname">fit_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.parameter.fit_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.parameter.fit_check" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to flip the uncertainty if we will fit a parameter</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.parameter.format_line">
<code class="sig-name descname">format_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.parameter.format_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.parameter.format_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats a string output to match the Pickett format for a parameter</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.parameter_scan">
<code class="sig-name descname">parameter_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameter</span></em>, <em class="sig-param"><span class="n">values</span></em>, <em class="sig-param"><span class="n">relaxed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.parameter_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.parameter_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for automatically scanning parameter space to see
what values give a minimum RMS.</p>
<p>We will repeatedly call SPFIT to estimate the fitting error
based on what the parameters are. There are two modes depending
on the <cite>relaxed</cite> variable: whether or not all other values are
allowed to relax (like a relaxed potential energy scan) or if
all parameters are held frozen.</p>
<p>Args:
parameter - a string input name of the parameter to change
values - a list or array of values to be scanned
relaxed - boolean determining whether the parameters are fixed</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.predict_lines">
<code class="sig-name descname">predict_lines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.predict_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.predict_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Run SPCAT to predict lines based on a .var and .int file.
This will operate in the current directory - since it does not
need to overwrite any files, we don’t actually back up anything!</p>
<p>The predicted lines are also parsed into a .csv file, and plot up
into: (A) a notebook inline plot, and (B) a PDF output.</p>
<p>SPCAT is run twice - first to get the partition function, and second
to get the correct intensities.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.report_parameters">
<code class="sig-name descname">report_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.report_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.report_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to return a dictionary of only the parameter values</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.restore_backup">
<code class="sig-name descname">restore_backup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.restore_backup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.restore_backup" title="Permalink to this definition">¶</a></dt>
<dd><p>Restores backed up files from the <cite>backup</cite> method</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.save_progress">
<code class="sig-name descname">save_progress</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.save_progress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.save_progress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.set_fit">
<code class="sig-name descname">set_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.set_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.set_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to flip all parameters to fit or not to fit.
The default behaviour, if nothing is provided, is to fit all the
parameters.</p>
<p>A list of parameters can be supplied to the params argument, which
will specifically fit or not fit those parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.setup_int">
<code class="sig-name descname">setup_int</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.setup_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.setup_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the int file. Order of things written:
1. units
2. molecular tag identifier
3. partition function
4. quantum number lower limit
5. quantum number upper limit
6. intensity threshold lower limit
7. intensity threshold upper limit
8. frequency limit in GHz
9. vibrational quantum number limit
10. dipole moments</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.setup_par">
<code class="sig-name descname">setup_par</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.setup_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.setup_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that provides the correct formatting for a .par file</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.toggle_interactive">
<code class="sig-name descname">toggle_interactive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">connected</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.toggle_interactive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.toggle_interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to toggle interactive plots on and off</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.MoleculeFit.update_parameters">
<code class="sig-name descname">update_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameters</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#MoleculeFit.update_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.MoleculeFit.update_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the simulation parameters
This is written with a loop in order to make sure the
keys that aren’t specified remain the same as before without
change.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.QuantumNumber">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.pypickett.</code><code class="sig-name descname">QuantumNumber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">upper</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">frozen</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">center</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">delta</span><span class="p">:</span> <span class="n">None</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#QuantumNumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for a Quantum Number.</p>
<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.center">
<code class="sig-name descname">center</code><em class="property">: int</em><em class="property"> = 1</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.center" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.delta">
<code class="sig-name descname">delta</code><em class="property">: None</em><em class="property"> = None</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.delta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.frozen">
<code class="sig-name descname">frozen</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.frozen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.j">
<code class="sig-name descname">j</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.j" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.QuantumNumber.roll">
<code class="sig-name descname">roll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#QuantumNumber.roll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.roll" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random value for the current quantum number.</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.QuantumNumber.spawn_upper">
<code class="sig-name descname">spawn_upper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#QuantumNumber.spawn_upper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.spawn_upper" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new QuantumNumber instance for the corresponding upper state.
Will also shift the quantum number to a new value, +/-2,1,0.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>QuantumNumber</strong> – A deep copy of the current QuantumNumber instance, but also shifts the
quantum number by a random integer.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.upper">
<code class="sig-name descname">upper</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.upper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.value">
<code class="sig-name descname">value</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.QuantumNumber.width">
<code class="sig-name descname">width</code><em class="property">: int</em><em class="property"> = 1</em><a class="headerlink" href="#pyspectools.pypickett.QuantumNumber.width" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyspectools.pypickett.Transition">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.pypickett.</code><code class="sig-name descname">Transition</code><span class="sig-paren">(</span><em class="sig-param">frequency: float</em>, <em class="sig-param">n_numbers: int</em>, <em class="sig-param">quantum_numbers: List = &lt;factory&gt;</em>, <em class="sig-param">j: List = &lt;factory&gt;</em>, <em class="sig-param">lower_state: List = &lt;factory&gt;</em>, <em class="sig-param">upper_state: List = &lt;factory&gt;</em>, <em class="sig-param">centers: List = &lt;factory&gt;</em>, <em class="sig-param">widths: List = &lt;factory&gt;</em>, <em class="sig-param">deltas: List = &lt;factory&gt;</em>, <em class="sig-param">uncertainty: float = 0.005</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#Transition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.Transition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.centers">
<code class="sig-name descname">centers</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.centers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.deltas">
<code class="sig-name descname">deltas</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.deltas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.frequency">
<code class="sig-name descname">frequency</code><em class="property">: float</em><a class="headerlink" href="#pyspectools.pypickett.Transition.frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.Transition.from_list">
<em class="property">classmethod </em><code class="sig-name descname">from_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em>, <em class="sig-param"><span class="n">qnos</span></em>, <em class="sig-param"><span class="n">uncertainty</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#Transition.from_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.Transition.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method to spawn a Transition from a list of quantum numbers.
This takes a flat iterable (qnos), and splits it into two; the first
half is used for the lower state quantum numbers, and the second half
the upper state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> (<em>float</em>) – Frequency of the transition in MHz</p></li>
<li><p><strong>qnos</strong> (<em>list</em>) – Flat list of quantum numbers, includes both lower and upper states</p></li>
<li><p><strong>uncertainty</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Optional frequency uncertainty of the transition in MHz. Defaults to None, which uses
the default value of 0.005 MHz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Transition</strong> – Transition object initialized with the specifications</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.j">
<code class="sig-name descname">j</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.j" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.lower_state">
<code class="sig-name descname">lower_state</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.lower_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.n_numbers">
<code class="sig-name descname">n_numbers</code><em class="property">: int</em><a class="headerlink" href="#pyspectools.pypickett.Transition.n_numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.quantum_numbers">
<code class="sig-name descname">quantum_numbers</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.quantum_numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.pypickett.Transition.random_quantum_numbers">
<code class="sig-name descname">random_quantum_numbers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/pypickett.html#Transition.random_quantum_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.pypickett.Transition.random_quantum_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a random set of quantum numbers for a transition. First, the lower state is generated based on
lower and upper bounds specified by the user. A deepcopy is made for each lower state quantum number,
and the associated upper state number is created by shifting the lower value by a random integer between
-2 and 2.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.uncertainty">
<code class="sig-name descname">uncertainty</code><em class="property">: float</em><em class="property"> = 0.005</em><a class="headerlink" href="#pyspectools.pypickett.Transition.uncertainty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.upper_state">
<code class="sig-name descname">upper_state</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.upper_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyspectools.pypickett.Transition.widths">
<code class="sig-name descname">widths</code><em class="property">: List</em><a class="headerlink" href="#pyspectools.pypickett.Transition.widths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyspectools.routines">
<span id="generic-routines-module"></span><h2>Generic routines module<a class="headerlink" href="#module-pyspectools.routines" title="Permalink to this headline">¶</a></h2>
<p>Routines to:
Parse cat files
Run SPFIT and/or SPCAT</p>
<dl class="py class">
<dt id="pyspectools.routines.RemoteClient">
<em class="property">class </em><code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">RemoteClient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hostname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">username</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">paramiko.client.SSHClient</span></code></p>
<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload a remote session from a pickle file created by the save_session.
:param filepath: str path to RemoteClient pickle file
:return: RemoteClient object</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.get_file">
<code class="sig-name descname">get_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">remote_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">local_path</span><span class="o">=</span><span class="default_value">'/home/kelvin/Python/PySpecTools/docs'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.get_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.get_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a file from remote server to disk. If no local path is provided, defaults
to the current working directory.
:param remote_path: str remote file path target
:param local_path: str optional path to save the file to</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.ls">
<code class="sig-name descname">ls</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">remote_path</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.ls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.ls" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get the list of files present in a specified directory.
Defaults to the current ssh directory.
:param remote_path: str remote path to inspect
:return: list of files and folders</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.open_remote">
<code class="sig-name descname">open_remote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">remote_path</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.open_remote"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.open_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to stream the file contents of a remote file. Can be used to directly
provide data into memory without downloading it to disk.
:param remote_path: str remote path to target file
:return: list of contents of the target file</p>
</dd></dl>

<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.run_command">
<code class="sig-name descname">run_command</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">command</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.run_command"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.run_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyspectools.routines.RemoteClient.save_session">
<code class="sig-name descname">save_session</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">'ssh.pkl'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#RemoteClient.save_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.RemoteClient.save_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to dump the ssh settings object to a pickle file. Keep in mind
that while this is a matter of convenience, the file is unencrypted and
so storing passwords in here is not exactly the safest thing to do!
:param filepath: str optional path to save the session to.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.backup_files">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">backup_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">molecule_name</span></em>, <em class="sig-param"><span class="n">save_location</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#backup_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.backup_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.copy_template">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">copy_template</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#copy_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.copy_template" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.decimal_length">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">decimal_length</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#decimal_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.decimal_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.dump_json">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">dump_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">json_filepath</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">json_dict</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Any<span class="p">, </span>Any<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#dump_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.dump_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to serialize a Python dictionary into a JSON file.
The pretty printing is enabled by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>json_filepath</strong> (<em>str</em>) – Path to the JSON file to save to</p></li>
<li><p><strong>json_dict</strong> (<em>Dict</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>]</em>) – Dictionary to be serialized</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.dump_packages">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">dump_packages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#dump_packages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.dump_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will return a list of packages that
have been loaded and their version numbers.</p>
<p>This function will ignore system packages:
sys, __builtins__, types, os</p>
<p>as well as modules with no version.</p>
<p>This is not working the way I want it to…</p>
<dl class="simple">
<dt>mod_dict - dict with keys corresponding to module name,</dt><dd><p>and values the version number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.dump_yaml">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">dump_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_filepath</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">yaml_dict</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Any<span class="p">, </span>Any<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#dump_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.dump_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to serialize a Python dictionary into a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>yaml_filepath</strong> (<em>str</em>) – Path to the YAML file</p></li>
<li><p><strong>yaml_dict</strong> (<em>Dict</em><em>[</em><em>Any</em><em>, </em><em>Any</em><em>]</em>) – Dictionary to be serialized</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.find_nearest">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">find_nearest</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">value</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>int<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>int<span class="p">]</span><a class="reference internal" href="_modules/pyspectools/routines.html#find_nearest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will find the nearest value in a NumPy array to a specified
value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.ndarray</em>) – NumPy 1D array</p></li>
<li><p><strong>value</strong> (<em>float</em>) – Value to search the array for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the closest value, as well as the index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[np.ndarray, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.flatten_list">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">flatten_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Any<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#flatten_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.flatten_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a nested list of values and flattens it. The code is written as a try/except that makes the assumption
that the data is a list/tuple/array, and in the case that it isn’t will simply append the item to the
output instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_list</strong> (<em>list</em>) – List of values, where some of the elements are lists</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_list</strong> – Flattened version of input_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.format_uncertainty">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">format_uncertainty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">uncertainty</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#format_uncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.format_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to determine the number of decimal places to
format the uncertainty. Probably not the most elegant way of doing this.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.generate_folder">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">generate_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#generate_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.generate_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the folder for the next calculation
and returns the next calculation number</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.group_consecutives">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">group_consecutives</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#group_consecutives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.group_consecutives" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to group all consecutive values in a list together. The primary purpose of this
is to split concatenated spectra that are given in a single list of frequencies
into individual windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vals</strong> (<em>list</em>) – List of floats to be split</p></li>
<li><p><strong>step</strong> (<em>int</em><em>, </em><em>optional</em>) – [description], by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.human2pickett">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">human2pickett</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">reduction</span><span class="o">=</span><span class="default_value">'A'</span></em>, <em class="sig-param"><span class="n">linear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">nuclei</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#human2pickett"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.human2pickett" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for translating a Hamiltonian parameter to a Pickett
identifier.</p>
<p>An alternative way of doing this is to programmatically
generate the Pickett identifiers, and just use format string
to output the identifier.</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.isnotebook">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">isnotebook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#isnotebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.isnotebook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.list_chunks">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">list_chunks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Any<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">n</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#list_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.list_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a list into a number of chunks with length n. If there are not enough elements,
the last chunk will finish the remaining elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>list</em>) – List to split into chunks</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of elements per chunk</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>split_list</strong> – Nested list of chunks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.list_directories">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">list_directories</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#list_directories"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.list_directories" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.read_json">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">read_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">json_filepath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>Any<span class="p">, </span>Any<span class="p">]</span><a class="reference internal" href="_modules/pyspectools/routines.html#read_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a JSON file into memory as a Python dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>json_filepath</strong> (<em>str</em>) – Path to the JSON file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary from JSON file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[Any, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.read_obj">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">read_obj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#read_obj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.read_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for joblib.load to load an object from disk</p>
<p>filepath - path to object</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.read_yaml">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">read_yaml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yaml_filepath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>Any<span class="p">, </span>Any<span class="p">]</span><a class="reference internal" href="_modules/pyspectools/routines.html#read_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.read_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load in a YAML file into a Python dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>yaml_filepath</strong> (<em>str</em>) – Path to the YAML file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary based on the YAML contents</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[Any, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.run_calbak">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">run_calbak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#run_calbak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.run_calbak" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the calbak routine, which generates a .lin file from the .cat</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.run_spcat">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">run_spcat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#run_spcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.run_spcat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.run_spfit">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">run_spfit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#run_spfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.run_spfit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.routines.save_obj">
<code class="sig-prename descclassname">pyspectools.routines.</code><code class="sig-name descname">save_obj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/routines.html#save_obj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.routines.save_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to serialize an object using dump from joblib.</p>
<p>Additional kwargs are passed into the dump, which can
be compression parameters, etc.</p>
<p>obj - instance of object to be serialized
filepath - filepath to save to</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools.units">
<span id="unit-conversions"></span><h2>Unit conversions<a class="headerlink" href="#module-pyspectools.units" title="Permalink to this headline">¶</a></h2>
<p>units.py</p>
<p>Routines for performing unit conversions and quantities
that are often used in spectroscopy.</p>
<dl class="py function">
<dt id="pyspectools.units.I2S">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">I2S</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">I</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Q</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">E_lower</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">300.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#I2S"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.I2S" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for converting intensity (in nm^2 MHz) to the more standard intrinsic linestrength, S_ij mu^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>T</em>) – The log of the transition intensity, typically given in catalog files</p></li>
<li><p><strong>- float</strong> – Partition function at specified temperature T</p></li>
<li><p><strong>- float</strong> – Frequency of the transition in MHz</p></li>
<li><p><strong>- float</strong> – ENergy of the lower state in wavenumbers</p></li>
<li><p><strong>- float</strong> – Temperature in Kelvin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of the intrinsic linestrength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>siju - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.MHz2cm">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">MHz2cm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#MHz2cm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.MHz2cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert MHz to wavenumbers
:param frequency: float
:return: corresponding value in 1/cm</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.S2I">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">S2I</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Q</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">E_lower</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">300.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#S2I"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.S2I" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for converting intensity (in nm^2 MHz) to the more standard intrinsic linestrength, S_ij mu^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>T</em>) – Intrinsic linestrength; Sij mu^2</p></li>
<li><p><strong>- float</strong> – Partition function at specified temperature T</p></li>
<li><p><strong>- float</strong> – Frequency of the transition in MHz</p></li>
<li><p><strong>- float</strong> – ENergy of the lower state in wavenumbers</p></li>
<li><p><strong>- float</strong> – Temperature in Kelvin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log10 of the intensity at the specified temperature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>I - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.T2wavenumber">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">T2wavenumber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#T2wavenumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.T2wavenumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert temperature in Kelvin to wavenumbers.
:param T: float
:return: corresponding value in 1/cm</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.approx_Q_linear">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">approx_Q_linear</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#approx_Q_linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.approx_Q_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximate rotational partition function for a linear molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>T</em>) – Rotational constant in MHz.</p></li>
<li><p><strong>- float</strong> – Temperature in Kelvin.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Rotational partition function at temperature T.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Q - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.approx_Q_top">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">approx_Q_top</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">C</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#approx_Q_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.approx_Q_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximate expression for the (a)symmetric top partition function. The expression is adapted from Gordy and Cook,
p.g. 57 equation 3.68. By default, the prolate top is used if the C constant is not specified, where B = C.
Oblate case can also be specified if A = C.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>T</em>) – Rotational constant for the A principal axis, in MHz.</p></li>
<li><p><strong>- float</strong> – Rotational constant for the B principal axis, in MHz.</p></li>
<li><p><strong>- float</strong> – Temperature in Kelvin</p></li>
<li><p><strong>- int</strong> (<em>sigma</em>) – Rotational level degeneracy; i.e. spin statistics</p></li>
<li><p><strong>- float</strong><strong>, </strong><strong>optional</strong> (<em>C</em>) – Rotational constant for the C principal axis, in MHz. Defaults to None, which will reduce to the prolate
top case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Partition function for the molecule at temperature T</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Q - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.boltzmann_factor">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">boltzmann_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#boltzmann_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.boltzmann_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Boltzmann weighting for a given state and temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>T</em>) – State energy in wavenumbers</p></li>
<li><p><strong>- float</strong> – Temperature in Kelvin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Unitless Boltzmann factor for the state</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boltzmann_factor - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.calc_E_lower">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">calc_E_lower</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">E_upper</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#calc_E_lower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.calc_E_lower" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the lower state energy, for a given lower state energy and the frequency of the transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>E_upper</em>) – Frequency of the transition in MHz</p></li>
<li><p><strong>- float</strong> – Upper state energy in wavenumbers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lower state energy in wavenumbers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>E_lower - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.calc_E_upper">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">calc_E_upper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">E_lower</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#calc_E_upper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.calc_E_upper" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the upper state energy, for a given lower state energy and the frequency of the transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>- float</strong> (<em>E_lower</em>) – Frequency of the transition in MHz</p></li>
<li><p><strong>- float</strong> – Lower state energy in wavenumbers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Upper state energy in wavenumbers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>E_upper - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.cm2MHz">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">cm2MHz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavenumber</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#cm2MHz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.cm2MHz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert wavenumbers to MHz
:param wavenumber: float
:return: corresponding value in MHz</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.dop2freq">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">dop2freq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">velocity</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#dop2freq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.dop2freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the expected frequency in MHz based on a Doppler shift in km/s and a center frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>velocity</strong> (<em>float</em>) – Radial velocity in km/s</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – Center frequency in MHz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>offset</strong> – The change in frequency associated with the velocity and</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.einsteinA">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">einsteinA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#einsteinA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.einsteinA" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Einstein A coefficient for a transition with
specified transition frequency and intrinsic linestrength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<em>float</em>) – Intrinsic linestrength; unitless</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – Transition frequency in MHz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Einstein A coefficient in units of per second</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.freq2vel">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">freq2vel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">offset</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#freq2vel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.freq2vel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Doppler shift in km/s based on a center frequency in MHz and n offset frequency in MHz (delta nu).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> (<em>float</em>) – Center frequency in MHz</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – Frequency offset from the center in MHz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>doppler</strong> – Doppler offset in km/s</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.gaussian_fwhm">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">gaussian_fwhm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#gaussian_fwhm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.gaussian_fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the full-width half maximum
value assuming a Gaussian function.</p>
<p>sigma - float for width</p>
<p>fwhm - float value for full-width at half-max</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.gaussian_height">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">gaussian_height</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">amplitude</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#gaussian_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.gaussian_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the height of a Gaussian distribution,
based on the amplitude and sigma. This value
corresponds to the peak height at the centroid.</p>
<p>amplitude - float
sigma - float</p>
<p>h - float</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.gaussian_integral">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">gaussian_integral</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">amplitude</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#gaussian_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.gaussian_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the integral of a Gaussian analytically using
the amplitude and sigma.
:param amplitude: amplitude of the Gaussian
:param sigma: width of the Gaussian
:return: integrated area of the Gaussian</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.hartree2K">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">hartree2K</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hartree</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#hartree2K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.hartree2K" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Hartrees to temperature in Kelvin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hartree</strong> (<em>float</em>) – Electronic energy in Hartrees</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kelvin</strong> – Corresponding value in Kelvin</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.hartree2eV">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">hartree2eV</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hartree</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#hartree2eV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.hartree2eV" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Hartrees to eV.
:param hartree: Electronic energy in Hartrees
:type hartree: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>eV</strong> – Corresponding value in eV</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.hartree2kjmol">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">hartree2kjmol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hartree</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#hartree2kjmol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.hartree2kjmol" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Hartrees to kJ/mol.
:param hartree: float
:return: converted value in kJ/mol</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.hartree2wavenumber">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">hartree2wavenumber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hartree</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#hartree2wavenumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.hartree2wavenumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Hartrees to wavenumbers.
:param hartree: float
:return: corresponding value in 1/cm</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.inertial_defect">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">inertial_defect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">C</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#inertial_defect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.inertial_defect" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the inertial defect of a molecule with a set of A, B, and C rotational constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>B</strong><strong>, </strong><strong>C - float</strong> (<em>A</em><em>,</em>) – Rotational constant along the respective principal axis in units of MHz.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inertial defect in units of amu Ang**2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>delta - float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.kappa">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">kappa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">C</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#kappa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Ray’s asymmetry parameter for a given set of A, B, and C rotational constants.
This parameter determines how asymmetric a molecule is by setting a range between two limits: the prolate (+1)
and the oblate (-1) limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>B</strong><strong>, </strong><strong>C</strong> (<em>A</em><em>,</em>) – Rotational constant in MHz for each respective axis</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kappa</strong> – Ray’s asymmetry parameter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.kjmol2wavenumber">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">kjmol2wavenumber</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kj</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#kjmol2wavenumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.kjmol2wavenumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert kJ/mol to wavenumbers
:param kj: float
:return: corresponding value in 1/cm</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.rotcon2pmi">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">rotcon2pmi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rotational_constant</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#rotcon2pmi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.rotcon2pmi" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert rotational constants in units of MHz to
Inertia, in units of amu A^2.</p>
<p>The conversion factor is adapted from:
Oka &amp; Morino, JMS (1962) 8, 9-21
This factor comprises h / pi^2 c.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rotational_constant</strong> – Corresponding rotational constant in MHz</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Rotational constant converted to units of amu A^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.thermal_corrections">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">thermal_corrections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequencies</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">T</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">linear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hartree</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#thermal_corrections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.thermal_corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the thermal contributions from nuclear motion, in the same way as
Gaussian does.
:param frequencies: Iterable of vibrational frequencies in wavenumbers. Can be Harmonic or Anharmonic fundamentals.
:type frequencies: list of floats or Numpy 1-D array
:param T: Value of the temperature to calculate thermal corrections at
:type T: float
:param linear: Specifies whether molecule is linear or not. Affects the rotational contribution.
:type linear: bool, optional
:param hartree: If True, converts the contribution into Hartrees. Otherwise, in units of Kelvin
:type hartree: bool, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>thermal</strong> – Total thermal contribution at a given temperature</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.wavenumber2T">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">wavenumber2T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavenumber</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#wavenumber2T"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.wavenumber2T" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert wavenumbers to Kelvin
:param wavenumber: float
:return: corresponding value in K</p>
</dd></dl>

<dl class="py function">
<dt id="pyspectools.units.wavenumber2kjmol">
<code class="sig-prename descclassname">pyspectools.units.</code><code class="sig-name descname">wavenumber2kjmol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavenumber</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyspectools/units.html#wavenumber2kjmol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyspectools.units.wavenumber2kjmol" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert wavenumbers to kJ/mol.
:param wavenumber: float
:return: converted value in kJ/mol</p>
</dd></dl>

</div>
<div class="section" id="module-pyspectools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyspectools" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017—2020, Kelvin Lee.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>